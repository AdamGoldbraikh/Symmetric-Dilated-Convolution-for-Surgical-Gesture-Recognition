Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_6', dataset='split6', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_6/test.txt', train_batch_size=1, train_label='Suturing/Split_6/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2679 Acc: 0.1737
Test Loss: 2.0121 Acc: 0.3532

Epoch 1/29
----------
Training Loss: 1.8396 Acc: 0.3802
Test Loss: 1.5845 Acc: 0.4583

Epoch 2/29
----------
Training Loss: 1.3540 Acc: 0.5598
Test Loss: 1.2473 Acc: 0.6094

Epoch 3/29
----------
Training Loss: 0.8778 Acc: 0.7457
Test Loss: 0.9696 Acc: 0.6765

Epoch 4/29
----------
Training Loss: 0.5914 Acc: 0.8123
Test Loss: 0.9085 Acc: 0.7262

Epoch 5/29
----------
Training Loss: 0.4380 Acc: 0.8598
Test Loss: 0.8550 Acc: 0.7522

Epoch 6/29
----------
Training Loss: 0.3609 Acc: 0.8842
Test Loss: 0.8683 Acc: 0.7585

Epoch 7/29
----------
Training Loss: 0.3005 Acc: 0.9027
Test Loss: 0.8042 Acc: 0.7713

Epoch 8/29
----------
Training Loss: 0.2613 Acc: 0.9104
Test Loss: 0.8024 Acc: 0.7819

Epoch 9/29
----------
Training Loss: 0.2219 Acc: 0.9201
Test Loss: 0.8841 Acc: 0.7631

Epoch 10/29
----------
Training Loss: 0.1977 Acc: 0.9276
Test Loss: 0.8490 Acc: 0.7791

Epoch 11/29
----------
Training Loss: 0.1791 Acc: 0.9340
Test Loss: 0.9500 Acc: 0.7618

Epoch 12/29
----------
Training Loss: 0.1569 Acc: 0.9417
Test Loss: 0.8891 Acc: 0.7714

Epoch 13/29
----------
Training Loss: 0.1523 Acc: 0.9428
Test Loss: 0.9698 Acc: 0.7679

Epoch 14/29
----------
Training Loss: 0.1497 Acc: 0.9436
Test Loss: 0.9848 Acc: 0.7771

Epoch 15/29
----------
Training Loss: 0.1495 Acc: 0.9426
Test Loss: 0.9522 Acc: 0.7826

Epoch 16/29
----------
Training Loss: 0.1373 Acc: 0.9494
Test Loss: 1.0357 Acc: 0.7849

Epoch 17/29
----------
Training Loss: 0.1229 Acc: 0.9524
Test Loss: 1.0013 Acc: 0.7857

Epoch 18/29
----------
Training Loss: 0.1131 Acc: 0.9568
Test Loss: 1.1872 Acc: 0.7698

Epoch 19/29
----------
Training Loss: 0.0999 Acc: 0.9614
Test Loss: 1.1128 Acc: 0.7765

Epoch 20/29
----------
Training Loss: 0.0984 Acc: 0.9612
Test Loss: 1.2054 Acc: 0.7873

Epoch 21/29
----------
Training Loss: 0.1116 Acc: 0.9565
Test Loss: 1.1466 Acc: 0.7849

Epoch 22/29
----------
Training Loss: 0.1059 Acc: 0.9598
Test Loss: 1.1671 Acc: 0.7881

Epoch 23/29
----------
Training Loss: 0.1182 Acc: 0.9555
Test Loss: 1.2388 Acc: 0.7731

Epoch 24/29
----------
Training Loss: 0.1284 Acc: 0.9544
Test Loss: 1.0772 Acc: 0.7923

Epoch 25/29
----------
Training Loss: 0.1083 Acc: 0.9589
Test Loss: 1.1873 Acc: 0.7872

Epoch 26/29
----------
Training Loss: 0.1092 Acc: 0.9589
Test Loss: 1.1740 Acc: 0.7845

Epoch 27/29
----------
Training Loss: 0.1018 Acc: 0.9598
Test Loss: 1.2000 Acc: 0.7867

Epoch 28/29
----------
Training Loss: 0.0859 Acc: 0.9663
Test Loss: 1.1740 Acc: 0.7893

Epoch 29/29
----------
Training Loss: 0.0944 Acc: 0.9655
Test Loss: 1.1067 Acc: 0.7934

Training complete in 1m 13s
Best val Acc: 0.793408
False
Evaluation Accuray: 0.7934
Edit: 79.0314
F1@0.10 : 81.7204
F1@0.25 : 77.4194
F1@0.50 : 63.4409
