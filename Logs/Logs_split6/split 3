Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_6', dataset='split3', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_3/test.txt', train_batch_size=1, train_label='Suturing/Split_3/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.5694 Acc: 0.1181
Test Loss: 2.1281 Acc: 0.1908

Epoch 1/29
----------
Training Loss: 1.9375 Acc: 0.3214
Test Loss: 1.6080 Acc: 0.3676

Epoch 2/29
----------
Training Loss: 1.2669 Acc: 0.5816
Test Loss: 1.1705 Acc: 0.6483

Epoch 3/29
----------
Training Loss: 0.7292 Acc: 0.7844
Test Loss: 1.0060 Acc: 0.7130

Epoch 4/29
----------
Training Loss: 0.5033 Acc: 0.8471
Test Loss: 0.9714 Acc: 0.7505

Epoch 5/29
----------
Training Loss: 0.4084 Acc: 0.8744
Test Loss: 0.9443 Acc: 0.7641

Epoch 6/29
----------
Training Loss: 0.3405 Acc: 0.8909
Test Loss: 0.9375 Acc: 0.7670

Epoch 7/29
----------
Training Loss: 0.3165 Acc: 0.8970
Test Loss: 0.9125 Acc: 0.7673

Epoch 8/29
----------
Training Loss: 0.2802 Acc: 0.9053
Test Loss: 0.9511 Acc: 0.7577

Epoch 9/29
----------
Training Loss: 0.2477 Acc: 0.9113
Test Loss: 0.9027 Acc: 0.7626

Epoch 10/29
----------
Training Loss: 0.2169 Acc: 0.9229
Test Loss: 0.8910 Acc: 0.7612

Epoch 11/29
----------
Training Loss: 0.2003 Acc: 0.9286
Test Loss: 0.7822 Acc: 0.7713

Epoch 12/29
----------
Training Loss: 0.1878 Acc: 0.9311
Test Loss: 0.9295 Acc: 0.7562

Epoch 13/29
----------
Training Loss: 0.1707 Acc: 0.9388
Test Loss: 0.9704 Acc: 0.7667

Epoch 14/29
----------
Training Loss: 0.1500 Acc: 0.9450
Test Loss: 0.9098 Acc: 0.7681

Epoch 15/29
----------
Training Loss: 0.1381 Acc: 0.9485
Test Loss: 0.9005 Acc: 0.7682

Epoch 16/29
----------
Training Loss: 0.1304 Acc: 0.9507
Test Loss: 0.9120 Acc: 0.7724

Epoch 17/29
----------
Training Loss: 0.1270 Acc: 0.9521
Test Loss: 0.8728 Acc: 0.7710

Epoch 18/29
----------
Training Loss: 0.1228 Acc: 0.9534
Test Loss: 0.8728 Acc: 0.7904

Epoch 19/29
----------
Training Loss: 0.1052 Acc: 0.9596
Test Loss: 1.1232 Acc: 0.7393

Epoch 20/29
----------
Training Loss: 0.1061 Acc: 0.9603
Test Loss: 1.0114 Acc: 0.7609

Epoch 21/29
----------
Training Loss: 0.1106 Acc: 0.9580
Test Loss: 0.9719 Acc: 0.7563

Epoch 22/29
----------
Training Loss: 0.1207 Acc: 0.9576
Test Loss: 1.2372 Acc: 0.7574

Epoch 23/29
----------
Training Loss: 0.0876 Acc: 0.9668
Test Loss: 0.8974 Acc: 0.7855

Epoch 24/29
----------
Training Loss: 0.0962 Acc: 0.9632
Test Loss: 1.4448 Acc: 0.7445

Epoch 25/29
----------
Training Loss: 0.0894 Acc: 0.9650
Test Loss: 0.9763 Acc: 0.7669

Epoch 26/29
----------
Training Loss: 0.0897 Acc: 0.9653
Test Loss: 1.0358 Acc: 0.7690

Epoch 27/29
----------
Training Loss: 0.0974 Acc: 0.9633
Test Loss: 0.9834 Acc: 0.7690

Epoch 28/29
----------
Training Loss: 0.1026 Acc: 0.9616
Test Loss: 1.3234 Acc: 0.7537

Epoch 29/29
----------
Training Loss: 0.0834 Acc: 0.9686
Test Loss: 1.1177 Acc: 0.7717

Training complete in 1m 17s
Best val Acc: 0.790417
False
Evaluation Accuray: 0.7904
Edit: 78.6399
F1@0.10 : 85.5615
F1@0.25 : 79.1444
F1@0.50 : 74.8663
