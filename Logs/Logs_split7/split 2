Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_7', dataset='split2', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_2/test.txt', train_batch_size=1, train_label='Suturing/Split_2/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3869 Acc: 0.1256
Test Loss: 2.0371 Acc: 0.3651

Epoch 1/29
----------
Training Loss: 1.8965 Acc: 0.3602
Test Loss: 1.4114 Acc: 0.4033

Epoch 2/29
----------
Training Loss: 1.4213 Acc: 0.5284
Test Loss: 0.8287 Acc: 0.7435

Epoch 3/29
----------
Training Loss: 0.9590 Acc: 0.7119
Test Loss: 0.4703 Acc: 0.8173

Epoch 4/29
----------
Training Loss: 0.6399 Acc: 0.8030
Test Loss: 0.3444 Acc: 0.8744

Epoch 5/29
----------
Training Loss: 0.4782 Acc: 0.8472
Test Loss: 0.3113 Acc: 0.8907

Epoch 6/29
----------
Training Loss: 0.3920 Acc: 0.8687
Test Loss: 0.2582 Acc: 0.9124

Epoch 7/29
----------
Training Loss: 0.3422 Acc: 0.8867
Test Loss: 0.2645 Acc: 0.9181

Epoch 8/29
----------
Training Loss: 0.2827 Acc: 0.9015
Test Loss: 0.2569 Acc: 0.9197

Epoch 9/29
----------
Training Loss: 0.2572 Acc: 0.9095
Test Loss: 0.3372 Acc: 0.9001

Epoch 10/29
----------
Training Loss: 0.2336 Acc: 0.9167
Test Loss: 0.2907 Acc: 0.9148

Epoch 11/29
----------
Training Loss: 0.2116 Acc: 0.9259
Test Loss: 0.2700 Acc: 0.9099

Epoch 12/29
----------
Training Loss: 0.2025 Acc: 0.9276
Test Loss: 0.2753 Acc: 0.9150

Epoch 13/29
----------
Training Loss: 0.1714 Acc: 0.9382
Test Loss: 0.2463 Acc: 0.9192

Epoch 14/29
----------
Training Loss: 0.1730 Acc: 0.9351
Test Loss: 0.2793 Acc: 0.9237

Epoch 15/29
----------
Training Loss: 0.1576 Acc: 0.9413
Test Loss: 0.3072 Acc: 0.9166

Epoch 16/29
----------
Training Loss: 0.1468 Acc: 0.9444
Test Loss: 0.2850 Acc: 0.9191

Epoch 17/29
----------
Training Loss: 0.1337 Acc: 0.9492
Test Loss: 0.3687 Acc: 0.9165

Epoch 18/29
----------
Training Loss: 0.1387 Acc: 0.9475
Test Loss: 0.3690 Acc: 0.9144

Epoch 19/29
----------
Training Loss: 0.1654 Acc: 0.9380
Test Loss: 0.3771 Acc: 0.9098

Epoch 20/29
----------
Training Loss: 0.1258 Acc: 0.9523
Test Loss: 0.3231 Acc: 0.9176

Epoch 21/29
----------
Training Loss: 0.1145 Acc: 0.9569
Test Loss: 0.3921 Acc: 0.9146

Epoch 22/29
----------
Training Loss: 0.1108 Acc: 0.9570
Test Loss: 0.3038 Acc: 0.9225

Epoch 23/29
----------
Training Loss: 0.1263 Acc: 0.9523
Test Loss: 0.3421 Acc: 0.9195

Epoch 24/29
----------
Training Loss: 0.1117 Acc: 0.9556
Test Loss: 0.2968 Acc: 0.9202

Epoch 25/29
----------
Training Loss: 0.1146 Acc: 0.9573
Test Loss: 0.3757 Acc: 0.9130

Epoch 26/29
----------
Training Loss: 0.1205 Acc: 0.9548
Test Loss: 0.3361 Acc: 0.9205

Epoch 27/29
----------
Training Loss: 0.1121 Acc: 0.9568
Test Loss: 0.3669 Acc: 0.9183

Epoch 28/29
----------
Training Loss: 0.1088 Acc: 0.9583
Test Loss: 0.4221 Acc: 0.9144

Epoch 29/29
----------
Training Loss: 0.1043 Acc: 0.9597
Test Loss: 0.4382 Acc: 0.9067

Training complete in 1m 18s
Best val Acc: 0.923724
False
Evaluation Accuray: 0.9237
Edit: 95.2922
F1@0.10 : 97.4359
F1@0.25 : 97.4359
F1@0.50 : 97.4359
