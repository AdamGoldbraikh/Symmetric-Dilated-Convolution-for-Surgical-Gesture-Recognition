Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_7', dataset='split5', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_5/test.txt', train_batch_size=1, train_label='Suturing/Split_5/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2820 Acc: 0.1515
Test Loss: 1.9163 Acc: 0.4076

Epoch 1/29
----------
Training Loss: 1.8848 Acc: 0.3616
Test Loss: 1.3366 Acc: 0.4641

Epoch 2/29
----------
Training Loss: 1.4159 Acc: 0.5304
Test Loss: 0.7835 Acc: 0.8031

Epoch 3/29
----------
Training Loss: 0.8960 Acc: 0.7363
Test Loss: 0.4323 Acc: 0.8690

Epoch 4/29
----------
Training Loss: 0.5859 Acc: 0.8169
Test Loss: 0.3075 Acc: 0.9051

Epoch 5/29
----------
Training Loss: 0.4553 Acc: 0.8498
Test Loss: 0.2712 Acc: 0.9027

Epoch 6/29
----------
Training Loss: 0.3659 Acc: 0.8785
Test Loss: 0.2467 Acc: 0.9080

Epoch 7/29
----------
Training Loss: 0.3165 Acc: 0.8926
Test Loss: 0.2459 Acc: 0.9079

Epoch 8/29
----------
Training Loss: 0.2747 Acc: 0.9054
Test Loss: 0.2081 Acc: 0.9170

Epoch 9/29
----------
Training Loss: 0.2374 Acc: 0.9157
Test Loss: 0.1985 Acc: 0.9240

Epoch 10/29
----------
Training Loss: 0.2091 Acc: 0.9229
Test Loss: 0.1812 Acc: 0.9356

Epoch 11/29
----------
Training Loss: 0.2063 Acc: 0.9230
Test Loss: 0.2452 Acc: 0.9054

Epoch 12/29
----------
Training Loss: 0.2011 Acc: 0.9264
Test Loss: 0.1899 Acc: 0.9289

Epoch 13/29
----------
Training Loss: 0.1823 Acc: 0.9318
Test Loss: 0.2029 Acc: 0.9200

Epoch 14/29
----------
Training Loss: 0.1625 Acc: 0.9400
Test Loss: 0.1947 Acc: 0.9289

Epoch 15/29
----------
Training Loss: 0.1439 Acc: 0.9441
Test Loss: 0.2564 Acc: 0.9177

Epoch 16/29
----------
Training Loss: 0.1358 Acc: 0.9478
Test Loss: 0.2043 Acc: 0.9298

Epoch 17/29
----------
Training Loss: 0.1301 Acc: 0.9503
Test Loss: 0.1905 Acc: 0.9357

Epoch 18/29
----------
Training Loss: 0.1241 Acc: 0.9543
Test Loss: 0.1982 Acc: 0.9325

Epoch 19/29
----------
Training Loss: 0.1315 Acc: 0.9501
Test Loss: 0.2018 Acc: 0.9258

Epoch 20/29
----------
Training Loss: 0.1137 Acc: 0.9557
Test Loss: 0.1985 Acc: 0.9337

Epoch 21/29
----------
Training Loss: 0.1105 Acc: 0.9573
Test Loss: 0.2584 Acc: 0.9234

Epoch 22/29
----------
Training Loss: 0.1206 Acc: 0.9554
Test Loss: 0.2022 Acc: 0.9281

Epoch 23/29
----------
Training Loss: 0.1260 Acc: 0.9521
Test Loss: 0.2217 Acc: 0.9219

Epoch 24/29
----------
Training Loss: 0.1287 Acc: 0.9527
Test Loss: 0.1830 Acc: 0.9364

Epoch 25/29
----------
Training Loss: 0.1037 Acc: 0.9611
Test Loss: 0.2549 Acc: 0.9243

Epoch 26/29
----------
Training Loss: 0.1028 Acc: 0.9592
Test Loss: 0.2294 Acc: 0.9252

Epoch 27/29
----------
Training Loss: 0.0921 Acc: 0.9648
Test Loss: 0.2699 Acc: 0.9262

Epoch 28/29
----------
Training Loss: 0.0868 Acc: 0.9648
Test Loss: 0.3081 Acc: 0.9147

Epoch 29/29
----------
Training Loss: 0.1111 Acc: 0.9578
Test Loss: 0.3090 Acc: 0.9203

Training complete in 1m 13s
Best val Acc: 0.936381
False
Evaluation Accuray: 0.9364
Edit: 98.6111
F1@0.10 : 98.6111
F1@0.25 : 98.6111
F1@0.50 : 98.6111
