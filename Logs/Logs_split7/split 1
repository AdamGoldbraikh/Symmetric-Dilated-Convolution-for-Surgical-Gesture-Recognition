Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_7', dataset='split1', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_1/test.txt', train_batch_size=1, train_label='Suturing/Split_1/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3554 Acc: 0.1378
Test Loss: 2.0280 Acc: 0.3416

Epoch 1/29
----------
Training Loss: 1.9015 Acc: 0.3534
Test Loss: 1.3635 Acc: 0.4785

Epoch 2/29
----------
Training Loss: 1.4224 Acc: 0.5435
Test Loss: 0.8471 Acc: 0.7560

Epoch 3/29
----------
Training Loss: 0.8913 Acc: 0.7396
Test Loss: 0.5923 Acc: 0.8203

Epoch 4/29
----------
Training Loss: 0.5812 Acc: 0.8115
Test Loss: 0.5076 Acc: 0.8490

Epoch 5/29
----------
Training Loss: 0.4254 Acc: 0.8563
Test Loss: 0.4313 Acc: 0.8820

Epoch 6/29
----------
Training Loss: 0.3585 Acc: 0.8767
Test Loss: 0.4674 Acc: 0.8701

Epoch 7/29
----------
Training Loss: 0.2957 Acc: 0.8970
Test Loss: 0.4444 Acc: 0.8931

Epoch 8/29
----------
Training Loss: 0.2648 Acc: 0.9075
Test Loss: 0.4557 Acc: 0.8968

Epoch 9/29
----------
Training Loss: 0.2293 Acc: 0.9167
Test Loss: 0.4487 Acc: 0.8933

Epoch 10/29
----------
Training Loss: 0.2144 Acc: 0.9209
Test Loss: 0.4345 Acc: 0.8974

Epoch 11/29
----------
Training Loss: 0.1947 Acc: 0.9280
Test Loss: 0.4670 Acc: 0.8937

Epoch 12/29
----------
Training Loss: 0.2047 Acc: 0.9272
Test Loss: 0.4116 Acc: 0.8936

Epoch 13/29
----------
Training Loss: 0.1752 Acc: 0.9343
Test Loss: 0.4507 Acc: 0.9009

Epoch 14/29
----------
Training Loss: 0.1590 Acc: 0.9396
Test Loss: 0.4529 Acc: 0.8998

Epoch 15/29
----------
Training Loss: 0.1673 Acc: 0.9375
Test Loss: 0.5251 Acc: 0.8894

Epoch 16/29
----------
Training Loss: 0.1467 Acc: 0.9447
Test Loss: 0.5018 Acc: 0.9013

Epoch 17/29
----------
Training Loss: 0.1484 Acc: 0.9431
Test Loss: 0.4826 Acc: 0.8922

Epoch 18/29
----------
Training Loss: 0.1424 Acc: 0.9461
Test Loss: 0.4836 Acc: 0.8822

Epoch 19/29
----------
Training Loss: 0.1324 Acc: 0.9490
Test Loss: 0.5229 Acc: 0.8975

Epoch 20/29
----------
Training Loss: 0.1145 Acc: 0.9572
Test Loss: 0.5077 Acc: 0.9027

Epoch 21/29
----------
Training Loss: 0.1136 Acc: 0.9567
Test Loss: 0.5829 Acc: 0.8878

Epoch 22/29
----------
Training Loss: 0.1177 Acc: 0.9533
Test Loss: 0.5420 Acc: 0.8982

Epoch 23/29
----------
Training Loss: 0.1273 Acc: 0.9513
Test Loss: 0.4967 Acc: 0.8808

Epoch 24/29
----------
Training Loss: 0.1173 Acc: 0.9542
Test Loss: 0.4812 Acc: 0.8933

Epoch 25/29
----------
Training Loss: 0.1031 Acc: 0.9591
Test Loss: 0.5440 Acc: 0.9010

Epoch 26/29
----------
Training Loss: 0.0997 Acc: 0.9610
Test Loss: 0.5401 Acc: 0.8943

Epoch 27/29
----------
Training Loss: 0.1060 Acc: 0.9605
Test Loss: 0.6512 Acc: 0.8796

Epoch 28/29
----------
Training Loss: 0.1297 Acc: 0.9519
Test Loss: 0.5568 Acc: 0.8836

Epoch 29/29
----------
Training Loss: 0.1010 Acc: 0.9615
Test Loss: 0.5813 Acc: 0.8867

Training complete in 1m 17s
Best val Acc: 0.902735
False
Evaluation Accuray: 0.9027
Edit: 94.2641
F1@0.10 : 96.6887
F1@0.25 : 95.3642
F1@0.50 : 88.7417
