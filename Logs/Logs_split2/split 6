Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_2', dataset='split6', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_6/test.txt', train_batch_size=1, train_label='Suturing/Split_6/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2737 Acc: 0.1659
Test Loss: 1.9269 Acc: 0.4066

Epoch 1/29
----------
Training Loss: 1.8603 Acc: 0.3841
Test Loss: 1.4248 Acc: 0.5321

Epoch 2/29
----------
Training Loss: 1.3442 Acc: 0.5723
Test Loss: 0.9281 Acc: 0.7198

Epoch 3/29
----------
Training Loss: 0.8157 Acc: 0.7600
Test Loss: 0.6217 Acc: 0.7801

Epoch 4/29
----------
Training Loss: 0.5279 Acc: 0.8301
Test Loss: 0.4825 Acc: 0.8487

Epoch 5/29
----------
Training Loss: 0.4065 Acc: 0.8684
Test Loss: 0.4761 Acc: 0.8505

Epoch 6/29
----------
Training Loss: 0.3300 Acc: 0.8931
Test Loss: 0.4334 Acc: 0.8571

Epoch 7/29
----------
Training Loss: 0.2826 Acc: 0.9053
Test Loss: 0.4686 Acc: 0.8510

Epoch 8/29
----------
Training Loss: 0.2374 Acc: 0.9155
Test Loss: 0.3615 Acc: 0.8723

Epoch 9/29
----------
Training Loss: 0.2187 Acc: 0.9224
Test Loss: 0.3459 Acc: 0.8769

Epoch 10/29
----------
Training Loss: 0.1982 Acc: 0.9285
Test Loss: 0.3203 Acc: 0.8828

Epoch 11/29
----------
Training Loss: 0.1743 Acc: 0.9361
Test Loss: 0.3477 Acc: 0.8906

Epoch 12/29
----------
Training Loss: 0.1611 Acc: 0.9414
Test Loss: 0.3259 Acc: 0.8808

Epoch 13/29
----------
Training Loss: 0.1504 Acc: 0.9443
Test Loss: 0.3403 Acc: 0.8868

Epoch 14/29
----------
Training Loss: 0.1435 Acc: 0.9472
Test Loss: 0.3485 Acc: 0.8881

Epoch 15/29
----------
Training Loss: 0.1206 Acc: 0.9549
Test Loss: 0.4033 Acc: 0.8843

Epoch 16/29
----------
Training Loss: 0.1298 Acc: 0.9513
Test Loss: 0.3057 Acc: 0.8956

Epoch 17/29
----------
Training Loss: 0.1311 Acc: 0.9497
Test Loss: 0.3613 Acc: 0.8843

Epoch 18/29
----------
Training Loss: 0.1290 Acc: 0.9505
Test Loss: 0.3262 Acc: 0.8876

Epoch 19/29
----------
Training Loss: 0.1389 Acc: 0.9467
Test Loss: 0.3665 Acc: 0.8854

Epoch 20/29
----------
Training Loss: 0.1076 Acc: 0.9597
Test Loss: 0.3021 Acc: 0.9020

Epoch 21/29
----------
Training Loss: 0.1003 Acc: 0.9617
Test Loss: 0.3325 Acc: 0.8889

Epoch 22/29
----------
Training Loss: 0.0921 Acc: 0.9636
Test Loss: 0.4717 Acc: 0.8837

Epoch 23/29
----------
Training Loss: 0.0952 Acc: 0.9627
Test Loss: 0.4381 Acc: 0.8875

Epoch 24/29
----------
Training Loss: 0.0906 Acc: 0.9652
Test Loss: 0.3712 Acc: 0.8917

Epoch 25/29
----------
Training Loss: 0.1086 Acc: 0.9603
Test Loss: 0.3069 Acc: 0.9086

Epoch 26/29
----------
Training Loss: 0.1150 Acc: 0.9589
Test Loss: 0.3351 Acc: 0.9079

Epoch 27/29
----------
Training Loss: 0.1083 Acc: 0.9595
Test Loss: 0.3836 Acc: 0.8916

Epoch 28/29
----------
Training Loss: 0.0887 Acc: 0.9666
Test Loss: 0.4815 Acc: 0.8743

Epoch 29/29
----------
Training Loss: 0.0904 Acc: 0.9655
Test Loss: 0.3653 Acc: 0.8981

Training complete in 1m 19s
Best val Acc: 0.908557
False
Evaluation Accuray: 0.9086
Edit: 88.1429
F1@0.10 : 90.1734
F1@0.25 : 90.1734
F1@0.50 : 86.7052
