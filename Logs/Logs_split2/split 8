Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_2', dataset='split8', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_8/test.txt', train_batch_size=1, train_label='Suturing/Split_8/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.4132 Acc: 0.0983
Test Loss: 2.1102 Acc: 0.1845

Epoch 1/29
----------
Training Loss: 1.9477 Acc: 0.3290
Test Loss: 1.5297 Acc: 0.4111

Epoch 2/29
----------
Training Loss: 1.4392 Acc: 0.5331
Test Loss: 1.0130 Acc: 0.6395

Epoch 3/29
----------
Training Loss: 0.9149 Acc: 0.7316
Test Loss: 0.6177 Acc: 0.8225

Epoch 4/29
----------
Training Loss: 0.6182 Acc: 0.8031
Test Loss: 0.5020 Acc: 0.8677

Epoch 5/29
----------
Training Loss: 0.4668 Acc: 0.8485
Test Loss: 0.4043 Acc: 0.8591

Epoch 6/29
----------
Training Loss: 0.3818 Acc: 0.8749
Test Loss: 0.3399 Acc: 0.9076

Epoch 7/29
----------
Training Loss: 0.3113 Acc: 0.8944
Test Loss: 0.2923 Acc: 0.9070

Epoch 8/29
----------
Training Loss: 0.2803 Acc: 0.9038
Test Loss: 0.2938 Acc: 0.9140

Epoch 9/29
----------
Training Loss: 0.2402 Acc: 0.9148
Test Loss: 0.3035 Acc: 0.9093

Epoch 10/29
----------
Training Loss: 0.2174 Acc: 0.9206
Test Loss: 0.2858 Acc: 0.8939

Epoch 11/29
----------
Training Loss: 0.2069 Acc: 0.9255
Test Loss: 0.2756 Acc: 0.9201

Epoch 12/29
----------
Training Loss: 0.1769 Acc: 0.9346
Test Loss: 0.2420 Acc: 0.9116

Epoch 13/29
----------
Training Loss: 0.1532 Acc: 0.9421
Test Loss: 0.2248 Acc: 0.9180

Epoch 14/29
----------
Training Loss: 0.1634 Acc: 0.9388
Test Loss: 0.2417 Acc: 0.9137

Epoch 15/29
----------
Training Loss: 0.1478 Acc: 0.9454
Test Loss: 0.2981 Acc: 0.9019

Epoch 16/29
----------
Training Loss: 0.1381 Acc: 0.9480
Test Loss: 0.2541 Acc: 0.9199

Epoch 17/29
----------
Training Loss: 0.1281 Acc: 0.9483
Test Loss: 0.2863 Acc: 0.9184

Epoch 18/29
----------
Training Loss: 0.1191 Acc: 0.9531
Test Loss: 0.2880 Acc: 0.9087

Epoch 19/29
----------
Training Loss: 0.1193 Acc: 0.9561
Test Loss: 0.2663 Acc: 0.9154

Epoch 20/29
----------
Training Loss: 0.1217 Acc: 0.9543
Test Loss: 0.2794 Acc: 0.9150

Epoch 21/29
----------
Training Loss: 0.1087 Acc: 0.9589
Test Loss: 0.3129 Acc: 0.9046

Epoch 22/29
----------
Training Loss: 0.1138 Acc: 0.9569
Test Loss: 0.3301 Acc: 0.9022

Epoch 23/29
----------
Training Loss: 0.1163 Acc: 0.9554
Test Loss: 0.2628 Acc: 0.9214

Epoch 24/29
----------
Training Loss: 0.1004 Acc: 0.9614
Test Loss: 0.3252 Acc: 0.9066

Epoch 25/29
----------
Training Loss: 0.0929 Acc: 0.9634
Test Loss: 0.2872 Acc: 0.9102

Epoch 26/29
----------
Training Loss: 0.1158 Acc: 0.9566
Test Loss: 0.3087 Acc: 0.9125

Epoch 27/29
----------
Training Loss: 0.1309 Acc: 0.9529
Test Loss: 0.3059 Acc: 0.9070

Epoch 28/29
----------
Training Loss: 0.1141 Acc: 0.9577
Test Loss: 0.3398 Acc: 0.9022

Epoch 29/29
----------
Training Loss: 0.0963 Acc: 0.9636
Test Loss: 0.2866 Acc: 0.9191

Training complete in 1m 23s
Best val Acc: 0.921448
False
Evaluation Accuray: 0.9214
Edit: 93.0736
F1@0.10 : 96.1538
F1@0.25 : 96.1538
F1@0.50 : 93.5897
