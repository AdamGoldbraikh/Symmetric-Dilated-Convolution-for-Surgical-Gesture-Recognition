Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_1', dataset='split6', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_6/test.txt', train_batch_size=1, train_label='Suturing/Split_6/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3316 Acc: 0.1182
Test Loss: 1.9893 Acc: 0.2020

Epoch 1/29
----------
Training Loss: 1.8736 Acc: 0.3310
Test Loss: 1.4696 Acc: 0.4499

Epoch 2/29
----------
Training Loss: 1.3736 Acc: 0.5344
Test Loss: 0.9872 Acc: 0.7056

Epoch 3/29
----------
Training Loss: 0.8662 Acc: 0.7400
Test Loss: 0.6462 Acc: 0.7702

Epoch 4/29
----------
Training Loss: 0.5706 Acc: 0.8151
Test Loss: 0.5314 Acc: 0.8428

Epoch 5/29
----------
Training Loss: 0.4279 Acc: 0.8603
Test Loss: 0.4695 Acc: 0.8554

Epoch 6/29
----------
Training Loss: 0.3576 Acc: 0.8809
Test Loss: 0.4366 Acc: 0.8605

Epoch 7/29
----------
Training Loss: 0.3184 Acc: 0.8937
Test Loss: 0.4111 Acc: 0.8696

Epoch 8/29
----------
Training Loss: 0.2715 Acc: 0.9101
Test Loss: 0.3627 Acc: 0.8787

Epoch 9/29
----------
Training Loss: 0.2393 Acc: 0.9145
Test Loss: 0.3618 Acc: 0.8818

Epoch 10/29
----------
Training Loss: 0.2183 Acc: 0.9196
Test Loss: 0.3407 Acc: 0.8902

Epoch 11/29
----------
Training Loss: 0.1996 Acc: 0.9262
Test Loss: 0.4264 Acc: 0.8743

Epoch 12/29
----------
Training Loss: 0.1842 Acc: 0.9330
Test Loss: 0.3630 Acc: 0.8856

Epoch 13/29
----------
Training Loss: 0.1688 Acc: 0.9374
Test Loss: 0.3528 Acc: 0.8882

Epoch 14/29
----------
Training Loss: 0.1572 Acc: 0.9407
Test Loss: 0.2763 Acc: 0.9024

Epoch 15/29
----------
Training Loss: 0.1414 Acc: 0.9473
Test Loss: 0.3905 Acc: 0.8855

Epoch 16/29
----------
Training Loss: 0.1263 Acc: 0.9528
Test Loss: 0.3456 Acc: 0.8931

Epoch 17/29
----------
Training Loss: 0.1288 Acc: 0.9531
Test Loss: 0.4325 Acc: 0.8805

Epoch 18/29
----------
Training Loss: 0.1294 Acc: 0.9482
Test Loss: 0.4780 Acc: 0.8857

Epoch 19/29
----------
Training Loss: 0.1333 Acc: 0.9510
Test Loss: 0.3993 Acc: 0.8890

Epoch 20/29
----------
Training Loss: 0.1243 Acc: 0.9530
Test Loss: 0.3727 Acc: 0.8998

Epoch 21/29
----------
Training Loss: 0.1098 Acc: 0.9579
Test Loss: 0.3799 Acc: 0.8960

Epoch 22/29
----------
Training Loss: 0.1067 Acc: 0.9590
Test Loss: 0.3294 Acc: 0.8967

Epoch 23/29
----------
Training Loss: 0.1034 Acc: 0.9613
Test Loss: 0.4408 Acc: 0.8800

Epoch 24/29
----------
Training Loss: 0.1159 Acc: 0.9561
Test Loss: 0.3783 Acc: 0.8959

Epoch 25/29
----------
Training Loss: 0.1001 Acc: 0.9616
Test Loss: 0.3449 Acc: 0.8956

Epoch 26/29
----------
Training Loss: 0.1029 Acc: 0.9594
Test Loss: 0.2626 Acc: 0.9115

Epoch 27/29
----------
Training Loss: 0.1292 Acc: 0.9512
Test Loss: 0.4211 Acc: 0.8816

Epoch 28/29
----------
Training Loss: 0.0969 Acc: 0.9616
Test Loss: 0.2742 Acc: 0.9155

Epoch 29/29
----------
Training Loss: 0.0871 Acc: 0.9667
Test Loss: 0.4178 Acc: 0.8839

Training complete in 1m 58s
Best val Acc: 0.915502
False
Evaluation Accuray: 0.9155
Edit: 86.6048
F1@0.10 : 90.5882
F1@0.25 : 90.5882
F1@0.50 : 87.0588
