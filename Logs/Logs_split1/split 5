Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_1', dataset='split5', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_5/test.txt', train_batch_size=1, train_label='Suturing/Split_5/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3030 Acc: 0.1452
Test Loss: 1.9441 Acc: 0.4550

Epoch 1/29
----------
Training Loss: 1.8464 Acc: 0.3807
Test Loss: 1.2986 Acc: 0.5228

Epoch 2/29
----------
Training Loss: 1.3534 Acc: 0.5539
Test Loss: 0.7238 Acc: 0.7963

Epoch 3/29
----------
Training Loss: 0.8808 Acc: 0.7352
Test Loss: 0.3985 Acc: 0.8767

Epoch 4/29
----------
Training Loss: 0.5987 Acc: 0.8142
Test Loss: 0.2707 Acc: 0.9013

Epoch 5/29
----------
Training Loss: 0.4392 Acc: 0.8597
Test Loss: 0.2155 Acc: 0.9243

Epoch 6/29
----------
Training Loss: 0.3464 Acc: 0.8894
Test Loss: 0.1979 Acc: 0.9333

Epoch 7/29
----------
Training Loss: 0.2969 Acc: 0.8993
Test Loss: 0.1965 Acc: 0.9322

Epoch 8/29
----------
Training Loss: 0.2695 Acc: 0.9093
Test Loss: 0.1573 Acc: 0.9387

Epoch 9/29
----------
Training Loss: 0.2288 Acc: 0.9178
Test Loss: 0.2131 Acc: 0.9271

Epoch 10/29
----------
Training Loss: 0.2083 Acc: 0.9259
Test Loss: 0.1964 Acc: 0.9338

Epoch 11/29
----------
Training Loss: 0.2061 Acc: 0.9260
Test Loss: 0.1596 Acc: 0.9379

Epoch 12/29
----------
Training Loss: 0.1798 Acc: 0.9347
Test Loss: 0.1597 Acc: 0.9447

Epoch 13/29
----------
Training Loss: 0.1679 Acc: 0.9366
Test Loss: 0.1347 Acc: 0.9512

Epoch 14/29
----------
Training Loss: 0.1470 Acc: 0.9435
Test Loss: 0.1610 Acc: 0.9458

Epoch 15/29
----------
Training Loss: 0.1521 Acc: 0.9442
Test Loss: 0.1601 Acc: 0.9424

Epoch 16/29
----------
Training Loss: 0.1656 Acc: 0.9417
Test Loss: 0.1361 Acc: 0.9480

Epoch 17/29
----------
Training Loss: 0.1393 Acc: 0.9472
Test Loss: 0.1775 Acc: 0.9350

Epoch 18/29
----------
Training Loss: 0.1365 Acc: 0.9498
Test Loss: 0.1961 Acc: 0.9329

Epoch 19/29
----------
Training Loss: 0.1373 Acc: 0.9481
Test Loss: 0.1524 Acc: 0.9446

Epoch 20/29
----------
Training Loss: 0.1200 Acc: 0.9548
Test Loss: 0.1895 Acc: 0.9347

Epoch 21/29
----------
Training Loss: 0.1442 Acc: 0.9463
Test Loss: 0.1693 Acc: 0.9464

Epoch 22/29
----------
Training Loss: 0.1309 Acc: 0.9503
Test Loss: 0.1590 Acc: 0.9449

Epoch 23/29
----------
Training Loss: 0.1433 Acc: 0.9482
Test Loss: 0.2241 Acc: 0.9279

Epoch 24/29
----------
Training Loss: 0.1458 Acc: 0.9476
Test Loss: 0.1754 Acc: 0.9378

Epoch 25/29
----------
Training Loss: 0.1129 Acc: 0.9572
Test Loss: 0.2081 Acc: 0.9339

Epoch 26/29
----------
Training Loss: 0.1071 Acc: 0.9575
Test Loss: 0.1857 Acc: 0.9378

Epoch 27/29
----------
Training Loss: 0.0890 Acc: 0.9657
Test Loss: 0.1816 Acc: 0.9455

Epoch 28/29
----------
Training Loss: 0.0878 Acc: 0.9671
Test Loss: 0.1778 Acc: 0.9424

Epoch 29/29
----------
Training Loss: 0.0778 Acc: 0.9698
Test Loss: 0.1822 Acc: 0.9412

Training complete in 1m 52s
Best val Acc: 0.951239
False
Evaluation Accuray: 0.9512
Edit: 98.6842
F1@0.10 : 99.3103
F1@0.25 : 99.3103
F1@0.50 : 99.3103
