Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_6', dataset='split6', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_6/test.txt', train_batch_size=1, train_label='Suturing/Split_6/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2437 Acc: 0.1781
Test Loss: 1.8896 Acc: 0.3631

Epoch 1/29
----------
Training Loss: 1.8070 Acc: 0.3925
Test Loss: 1.4839 Acc: 0.4443

Epoch 2/29
----------
Training Loss: 1.2427 Acc: 0.6131
Test Loss: 1.1051 Acc: 0.6360

Epoch 3/29
----------
Training Loss: 0.7508 Acc: 0.7770
Test Loss: 0.9317 Acc: 0.7255

Epoch 4/29
----------
Training Loss: 0.5095 Acc: 0.8380
Test Loss: 0.8971 Acc: 0.7509

Epoch 5/29
----------
Training Loss: 0.3956 Acc: 0.8687
Test Loss: 0.8622 Acc: 0.7728

Epoch 6/29
----------
Training Loss: 0.3089 Acc: 0.8994
Test Loss: 0.8731 Acc: 0.7719

Epoch 7/29
----------
Training Loss: 0.2847 Acc: 0.9036
Test Loss: 0.8183 Acc: 0.7878

Epoch 8/29
----------
Training Loss: 0.2317 Acc: 0.9187
Test Loss: 0.8474 Acc: 0.7871

Epoch 9/29
----------
Training Loss: 0.2115 Acc: 0.9240
Test Loss: 0.8995 Acc: 0.7898

Epoch 10/29
----------
Training Loss: 0.1892 Acc: 0.9313
Test Loss: 0.8947 Acc: 0.7956

Epoch 11/29
----------
Training Loss: 0.1759 Acc: 0.9373
Test Loss: 1.0376 Acc: 0.7835

Epoch 12/29
----------
Training Loss: 0.1513 Acc: 0.9449
Test Loss: 0.9630 Acc: 0.8049

Epoch 13/29
----------
Training Loss: 0.1422 Acc: 0.9490
Test Loss: 1.1313 Acc: 0.7814

Epoch 14/29
----------
Training Loss: 0.1476 Acc: 0.9438
Test Loss: 1.0324 Acc: 0.7947

Epoch 15/29
----------
Training Loss: 0.1473 Acc: 0.9455
Test Loss: 1.0902 Acc: 0.7779

Epoch 16/29
----------
Training Loss: 0.1297 Acc: 0.9512
Test Loss: 1.1226 Acc: 0.7869

Epoch 17/29
----------
Training Loss: 0.1216 Acc: 0.9552
Test Loss: 1.0934 Acc: 0.7961

Epoch 18/29
----------
Training Loss: 0.1144 Acc: 0.9574
Test Loss: 1.0267 Acc: 0.8023

Epoch 19/29
----------
Training Loss: 0.0932 Acc: 0.9633
Test Loss: 1.0963 Acc: 0.7942

Epoch 20/29
----------
Training Loss: 0.1178 Acc: 0.9569
Test Loss: 1.0435 Acc: 0.7998

Epoch 21/29
----------
Training Loss: 0.1195 Acc: 0.9555
Test Loss: 1.1779 Acc: 0.7825

Epoch 22/29
----------
Training Loss: 0.1041 Acc: 0.9599
Test Loss: 1.1585 Acc: 0.7936

Epoch 23/29
----------
Training Loss: 0.0952 Acc: 0.9623
Test Loss: 1.2444 Acc: 0.7752

Epoch 24/29
----------
Training Loss: 0.0933 Acc: 0.9635
Test Loss: 1.1300 Acc: 0.8060

Epoch 25/29
----------
Training Loss: 0.0897 Acc: 0.9657
Test Loss: 1.1380 Acc: 0.7940

Epoch 26/29
----------
Training Loss: 0.0811 Acc: 0.9682
Test Loss: 1.2330 Acc: 0.8061

Epoch 27/29
----------
Training Loss: 0.0760 Acc: 0.9702
Test Loss: 1.2424 Acc: 0.7947

Epoch 28/29
----------
Training Loss: 0.0884 Acc: 0.9667
Test Loss: 1.2707 Acc: 0.7923

Epoch 29/29
----------
Training Loss: 0.0786 Acc: 0.9690
Test Loss: 1.4097 Acc: 0.7631

Training complete in 1m 23s
Best val Acc: 0.806142
False
Evaluation Accuray: 0.8061
Edit: 82.5607
F1@0.10 : 86.2069
F1@0.25 : 83.9080
F1@0.50 : 73.5632
