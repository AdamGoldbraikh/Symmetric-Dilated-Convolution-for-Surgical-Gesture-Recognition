Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_8', dataset='split8', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_8/test.txt', train_batch_size=1, train_label='Suturing/Split_8/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2419 Acc: 0.2247
Test Loss: 1.9304 Acc: 0.3423

Epoch 1/29
----------
Training Loss: 1.8872 Acc: 0.3594
Test Loss: 1.5027 Acc: 0.4380

Epoch 2/29
----------
Training Loss: 1.3822 Acc: 0.5484
Test Loss: 1.0950 Acc: 0.6104

Epoch 3/29
----------
Training Loss: 0.8375 Acc: 0.7507
Test Loss: 0.8845 Acc: 0.7080

Epoch 4/29
----------
Training Loss: 0.5357 Acc: 0.8343
Test Loss: 0.7780 Acc: 0.7924

Epoch 5/29
----------
Training Loss: 0.3819 Acc: 0.8766
Test Loss: 0.7962 Acc: 0.7976

Epoch 6/29
----------
Training Loss: 0.2960 Acc: 0.8991
Test Loss: 0.7630 Acc: 0.8159

Epoch 7/29
----------
Training Loss: 0.2614 Acc: 0.9082
Test Loss: 0.7559 Acc: 0.7992

Epoch 8/29
----------
Training Loss: 0.2199 Acc: 0.9229
Test Loss: 0.9018 Acc: 0.7668

Epoch 9/29
----------
Training Loss: 0.1963 Acc: 0.9304
Test Loss: 0.8124 Acc: 0.7987

Epoch 10/29
----------
Training Loss: 0.1733 Acc: 0.9362
Test Loss: 0.7902 Acc: 0.7850

Epoch 11/29
----------
Training Loss: 0.1540 Acc: 0.9435
Test Loss: 0.9329 Acc: 0.7870

Epoch 12/29
----------
Training Loss: 0.1377 Acc: 0.9470
Test Loss: 0.9357 Acc: 0.7722

Epoch 13/29
----------
Training Loss: 0.1273 Acc: 0.9513
Test Loss: 0.9184 Acc: 0.7775

Epoch 14/29
----------
Training Loss: 0.1303 Acc: 0.9512
Test Loss: 1.0537 Acc: 0.7659

Epoch 15/29
----------
Training Loss: 0.1391 Acc: 0.9470
Test Loss: 1.2310 Acc: 0.7235

Epoch 16/29
----------
Training Loss: 0.1177 Acc: 0.9560
Test Loss: 1.1595 Acc: 0.7656

Epoch 17/29
----------
Training Loss: 0.1231 Acc: 0.9548
Test Loss: 1.1115 Acc: 0.7668

Epoch 18/29
----------
Training Loss: 0.1086 Acc: 0.9580
Test Loss: 1.0037 Acc: 0.7847

Epoch 19/29
----------
Training Loss: 0.1018 Acc: 0.9613
Test Loss: 1.3355 Acc: 0.7285

Epoch 20/29
----------
Training Loss: 0.1006 Acc: 0.9615
Test Loss: 1.3983 Acc: 0.7370

Epoch 21/29
----------
Training Loss: 0.1009 Acc: 0.9615
Test Loss: 1.0368 Acc: 0.7889

Epoch 22/29
----------
Training Loss: 0.1019 Acc: 0.9608
Test Loss: 1.4513 Acc: 0.7257

Epoch 23/29
----------
Training Loss: 0.1176 Acc: 0.9549
Test Loss: 1.1909 Acc: 0.7368

Epoch 24/29
----------
Training Loss: 0.1087 Acc: 0.9600
Test Loss: 1.1342 Acc: 0.7819

Epoch 25/29
----------
Training Loss: 0.0870 Acc: 0.9668
Test Loss: 1.2020 Acc: 0.7649

Epoch 26/29
----------
Training Loss: 0.0770 Acc: 0.9697
Test Loss: 1.1154 Acc: 0.7927

Epoch 27/29
----------
Training Loss: 0.0913 Acc: 0.9657
Test Loss: 1.2939 Acc: 0.7602

Epoch 28/29
----------
Training Loss: 0.0895 Acc: 0.9660
Test Loss: 1.1134 Acc: 0.7877

Epoch 29/29
----------
Training Loss: 0.0807 Acc: 0.9682
Test Loss: 1.4457 Acc: 0.7432

Training complete in 1m 25s
Best val Acc: 0.815939
False
Evaluation Accuray: 0.8159
Edit: 67.8732
F1@0.10 : 79.7927
F1@0.25 : 78.7565
F1@0.50 : 68.3938
