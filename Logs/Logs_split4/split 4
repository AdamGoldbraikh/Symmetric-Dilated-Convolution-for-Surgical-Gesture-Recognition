Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_4', dataset='split4', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_4/test.txt', train_batch_size=1, train_label='Suturing/Split_4/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2365 Acc: 0.1898
Test Loss: 1.7600 Acc: 0.4822

Epoch 1/29
----------
Training Loss: 1.7570 Acc: 0.4056
Test Loss: 1.3437 Acc: 0.4699

Epoch 2/29
----------
Training Loss: 1.2439 Acc: 0.6043
Test Loss: 0.8650 Acc: 0.7112

Epoch 3/29
----------
Training Loss: 0.7531 Acc: 0.7708
Test Loss: 0.5565 Acc: 0.7942

Epoch 4/29
----------
Training Loss: 0.5037 Acc: 0.8406
Test Loss: 0.4799 Acc: 0.8303

Epoch 5/29
----------
Training Loss: 0.3761 Acc: 0.8728
Test Loss: 0.4774 Acc: 0.8520

Epoch 6/29
----------
Training Loss: 0.3001 Acc: 0.8979
Test Loss: 0.5536 Acc: 0.8411

Epoch 7/29
----------
Training Loss: 0.2551 Acc: 0.9118
Test Loss: 0.6085 Acc: 0.8368

Epoch 8/29
----------
Training Loss: 0.2259 Acc: 0.9205
Test Loss: 0.5758 Acc: 0.8525

Epoch 9/29
----------
Training Loss: 0.1999 Acc: 0.9262
Test Loss: 0.6553 Acc: 0.8366

Epoch 10/29
----------
Training Loss: 0.1760 Acc: 0.9362
Test Loss: 0.6411 Acc: 0.8336

Epoch 11/29
----------
Training Loss: 0.1625 Acc: 0.9399
Test Loss: 0.5951 Acc: 0.8510

Epoch 12/29
----------
Training Loss: 0.1607 Acc: 0.9417
Test Loss: 0.6029 Acc: 0.8418

Epoch 13/29
----------
Training Loss: 0.1494 Acc: 0.9447
Test Loss: 0.6872 Acc: 0.8328

Epoch 14/29
----------
Training Loss: 0.1318 Acc: 0.9497
Test Loss: 0.7850 Acc: 0.8344

Epoch 15/29
----------
Training Loss: 0.1295 Acc: 0.9511
Test Loss: 0.7397 Acc: 0.8307

Epoch 16/29
----------
Training Loss: 0.1161 Acc: 0.9571
Test Loss: 0.7104 Acc: 0.8359

Epoch 17/29
----------
Training Loss: 0.1163 Acc: 0.9554
Test Loss: 0.7141 Acc: 0.8309

Epoch 18/29
----------
Training Loss: 0.1116 Acc: 0.9582
Test Loss: 0.7446 Acc: 0.8322

Epoch 19/29
----------
Training Loss: 0.1247 Acc: 0.9532
Test Loss: 0.6619 Acc: 0.8439

Epoch 20/29
----------
Training Loss: 0.1199 Acc: 0.9558
Test Loss: 0.7335 Acc: 0.8310

Epoch 21/29
----------
Training Loss: 0.1016 Acc: 0.9605
Test Loss: 0.8725 Acc: 0.8149

Epoch 22/29
----------
Training Loss: 0.0995 Acc: 0.9625
Test Loss: 0.8353 Acc: 0.8304

Epoch 23/29
----------
Training Loss: 0.0919 Acc: 0.9645
Test Loss: 0.6871 Acc: 0.8430

Epoch 24/29
----------
Training Loss: 0.0907 Acc: 0.9659
Test Loss: 0.8425 Acc: 0.8189

Epoch 25/29
----------
Training Loss: 0.0874 Acc: 0.9670
Test Loss: 0.7521 Acc: 0.8423

Epoch 26/29
----------
Training Loss: 0.0977 Acc: 0.9618
Test Loss: 0.9337 Acc: 0.8134

Epoch 27/29
----------
Training Loss: 0.0892 Acc: 0.9669
Test Loss: 0.7532 Acc: 0.8460

Epoch 28/29
----------
Training Loss: 0.0851 Acc: 0.9678
Test Loss: 0.7795 Acc: 0.8337

Epoch 29/29
----------
Training Loss: 0.0739 Acc: 0.9710
Test Loss: 0.8784 Acc: 0.8310

Training complete in 1m 40s
Best val Acc: 0.852458
False
Evaluation Accuray: 0.8525
Edit: 82.8875
F1@0.10 : 87.6543
F1@0.25 : 86.4198
F1@0.50 : 81.4815
