Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_4', dataset='split1', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_1/test.txt', train_batch_size=1, train_label='Suturing/Split_1/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2208 Acc: 0.2029
Test Loss: 1.9585 Acc: 0.4570

Epoch 1/29
----------
Training Loss: 1.8467 Acc: 0.3842
Test Loss: 1.3599 Acc: 0.5587

Epoch 2/29
----------
Training Loss: 1.3867 Acc: 0.5437
Test Loss: 0.8220 Acc: 0.7807

Epoch 3/29
----------
Training Loss: 0.8495 Acc: 0.7445
Test Loss: 0.5002 Acc: 0.8545

Epoch 4/29
----------
Training Loss: 0.5356 Acc: 0.8309
Test Loss: 0.4001 Acc: 0.8814

Epoch 5/29
----------
Training Loss: 0.4004 Acc: 0.8722
Test Loss: 0.3948 Acc: 0.8609

Epoch 6/29
----------
Training Loss: 0.3356 Acc: 0.8897
Test Loss: 0.3585 Acc: 0.8841

Epoch 7/29
----------
Training Loss: 0.2794 Acc: 0.9055
Test Loss: 0.4102 Acc: 0.8811

Epoch 8/29
----------
Training Loss: 0.2392 Acc: 0.9158
Test Loss: 0.3988 Acc: 0.8796

Epoch 9/29
----------
Training Loss: 0.2054 Acc: 0.9264
Test Loss: 0.4154 Acc: 0.8823

Epoch 10/29
----------
Training Loss: 0.2005 Acc: 0.9290
Test Loss: 0.4863 Acc: 0.8830

Epoch 11/29
----------
Training Loss: 0.1786 Acc: 0.9354
Test Loss: 0.4927 Acc: 0.8636

Epoch 12/29
----------
Training Loss: 0.1607 Acc: 0.9405
Test Loss: 0.4997 Acc: 0.8883

Epoch 13/29
----------
Training Loss: 0.1512 Acc: 0.9453
Test Loss: 0.4894 Acc: 0.8686

Epoch 14/29
----------
Training Loss: 0.1560 Acc: 0.9434
Test Loss: 0.4932 Acc: 0.8928

Epoch 15/29
----------
Training Loss: 0.1318 Acc: 0.9509
Test Loss: 0.5376 Acc: 0.8709

Epoch 16/29
----------
Training Loss: 0.1165 Acc: 0.9564
Test Loss: 0.5466 Acc: 0.8950

Epoch 17/29
----------
Training Loss: 0.1108 Acc: 0.9561
Test Loss: 0.5593 Acc: 0.8808

Epoch 18/29
----------
Training Loss: 0.1202 Acc: 0.9555
Test Loss: 0.6053 Acc: 0.8820

Epoch 19/29
----------
Training Loss: 0.1121 Acc: 0.9577
Test Loss: 0.5591 Acc: 0.8787

Epoch 20/29
----------
Training Loss: 0.1119 Acc: 0.9583
Test Loss: 0.5962 Acc: 0.8790

Epoch 21/29
----------
Training Loss: 0.1174 Acc: 0.9568
Test Loss: 0.4900 Acc: 0.8816

Epoch 22/29
----------
Training Loss: 0.0983 Acc: 0.9623
Test Loss: 0.6089 Acc: 0.8952

Epoch 23/29
----------
Training Loss: 0.1067 Acc: 0.9587
Test Loss: 0.4855 Acc: 0.8912

Epoch 24/29
----------
Training Loss: 0.0934 Acc: 0.9636
Test Loss: 0.5975 Acc: 0.8763

Epoch 25/29
----------
Training Loss: 0.0897 Acc: 0.9663
Test Loss: 0.5268 Acc: 0.8784

Epoch 26/29
----------
Training Loss: 0.0893 Acc: 0.9651
Test Loss: 0.5428 Acc: 0.8800

Epoch 27/29
----------
Training Loss: 0.1060 Acc: 0.9608
Test Loss: 0.5027 Acc: 0.8907

Epoch 28/29
----------
Training Loss: 0.0931 Acc: 0.9638
Test Loss: 0.5434 Acc: 0.8919

Epoch 29/29
----------
Training Loss: 0.0873 Acc: 0.9671
Test Loss: 0.6764 Acc: 0.8889

Training complete in 1m 35s
Best val Acc: 0.895210
False
Evaluation Accuray: 0.8952
Edit: 92.0635
F1@0.10 : 95.9459
F1@0.25 : 94.5946
F1@0.50 : 90.5405
