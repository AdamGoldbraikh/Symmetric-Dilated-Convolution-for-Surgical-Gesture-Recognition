Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_4', dataset='split4', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_4/test.txt', train_batch_size=1, train_label='Suturing/Split_4/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2745 Acc: 0.1521
Test Loss: 2.0765 Acc: 0.3642

Epoch 1/29
----------
Training Loss: 1.8727 Acc: 0.3711
Test Loss: 1.5441 Acc: 0.4980

Epoch 2/29
----------
Training Loss: 1.3830 Acc: 0.5452
Test Loss: 1.1079 Acc: 0.6564

Epoch 3/29
----------
Training Loss: 0.8701 Acc: 0.7467
Test Loss: 0.7176 Acc: 0.7482

Epoch 4/29
----------
Training Loss: 0.5555 Acc: 0.8256
Test Loss: 0.5322 Acc: 0.8205

Epoch 5/29
----------
Training Loss: 0.4153 Acc: 0.8613
Test Loss: 0.5221 Acc: 0.8519

Epoch 6/29
----------
Training Loss: 0.3264 Acc: 0.8873
Test Loss: 0.4845 Acc: 0.8616

Epoch 7/29
----------
Training Loss: 0.2792 Acc: 0.9020
Test Loss: 0.5135 Acc: 0.8566

Epoch 8/29
----------
Training Loss: 0.2339 Acc: 0.9157
Test Loss: 0.5422 Acc: 0.8517

Epoch 9/29
----------
Training Loss: 0.2112 Acc: 0.9232
Test Loss: 0.4913 Acc: 0.8634

Epoch 10/29
----------
Training Loss: 0.1936 Acc: 0.9293
Test Loss: 0.5885 Acc: 0.8519

Epoch 11/29
----------
Training Loss: 0.1752 Acc: 0.9352
Test Loss: 0.5634 Acc: 0.8538

Epoch 12/29
----------
Training Loss: 0.1721 Acc: 0.9379
Test Loss: 0.5995 Acc: 0.8396

Epoch 13/29
----------
Training Loss: 0.1483 Acc: 0.9445
Test Loss: 0.6150 Acc: 0.8432

Epoch 14/29
----------
Training Loss: 0.1375 Acc: 0.9489
Test Loss: 0.7188 Acc: 0.8359

Epoch 15/29
----------
Training Loss: 0.1435 Acc: 0.9460
Test Loss: 0.7298 Acc: 0.8236

Epoch 16/29
----------
Training Loss: 0.1314 Acc: 0.9512
Test Loss: 0.6778 Acc: 0.8421

Epoch 17/29
----------
Training Loss: 0.1447 Acc: 0.9475
Test Loss: 0.7045 Acc: 0.8408

Epoch 18/29
----------
Training Loss: 0.1289 Acc: 0.9512
Test Loss: 0.6541 Acc: 0.8456

Epoch 19/29
----------
Training Loss: 0.1289 Acc: 0.9527
Test Loss: 0.6596 Acc: 0.8359

Epoch 20/29
----------
Training Loss: 0.1100 Acc: 0.9578
Test Loss: 0.7763 Acc: 0.8381

Epoch 21/29
----------
Training Loss: 0.1049 Acc: 0.9611
Test Loss: 0.6397 Acc: 0.8522

Epoch 22/29
----------
Training Loss: 0.0995 Acc: 0.9618
Test Loss: 0.8804 Acc: 0.8093

Epoch 23/29
----------
Training Loss: 0.1054 Acc: 0.9607
Test Loss: 0.7520 Acc: 0.8366

Epoch 24/29
----------
Training Loss: 0.0974 Acc: 0.9626
Test Loss: 0.9962 Acc: 0.8088

Epoch 25/29
----------
Training Loss: 0.0894 Acc: 0.9650
Test Loss: 0.7451 Acc: 0.8490

Epoch 26/29
----------
Training Loss: 0.1008 Acc: 0.9614
Test Loss: 1.0363 Acc: 0.8005

Epoch 27/29
----------
Training Loss: 0.1128 Acc: 0.9576
Test Loss: 1.0313 Acc: 0.8070

Epoch 28/29
----------
Training Loss: 0.1035 Acc: 0.9608
Test Loss: 1.1453 Acc: 0.8110

Epoch 29/29
----------
Training Loss: 0.0832 Acc: 0.9673
Test Loss: 0.8921 Acc: 0.8164

Training complete in 1m 38s
Best val Acc: 0.863362
False
Evaluation Accuray: 0.8634
Edit: 86.3932
F1@0.10 : 90.4459
F1@0.25 : 90.4459
F1@0.50 : 85.3503
