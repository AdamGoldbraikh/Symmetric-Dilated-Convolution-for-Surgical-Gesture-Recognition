Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_4', dataset='split3', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_3/test.txt', train_batch_size=1, train_label='Suturing/Split_3/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2928 Acc: 0.1451
Test Loss: 2.0954 Acc: 0.3195

Epoch 1/29
----------
Training Loss: 1.8630 Acc: 0.3599
Test Loss: 1.7879 Acc: 0.3475

Epoch 2/29
----------
Training Loss: 1.3318 Acc: 0.5606
Test Loss: 1.4058 Acc: 0.5953

Epoch 3/29
----------
Training Loss: 0.8160 Acc: 0.7503
Test Loss: 1.2788 Acc: 0.6812

Epoch 4/29
----------
Training Loss: 0.5297 Acc: 0.8335
Test Loss: 1.2413 Acc: 0.7092

Epoch 5/29
----------
Training Loss: 0.4023 Acc: 0.8680
Test Loss: 1.1829 Acc: 0.7390

Epoch 6/29
----------
Training Loss: 0.3347 Acc: 0.8871
Test Loss: 1.0503 Acc: 0.7649

Epoch 7/29
----------
Training Loss: 0.2856 Acc: 0.9009
Test Loss: 1.0308 Acc: 0.7634

Epoch 8/29
----------
Training Loss: 0.2513 Acc: 0.9105
Test Loss: 0.9980 Acc: 0.7613

Epoch 9/29
----------
Training Loss: 0.2165 Acc: 0.9242
Test Loss: 1.0352 Acc: 0.7685

Epoch 10/29
----------
Training Loss: 0.1980 Acc: 0.9280
Test Loss: 1.0366 Acc: 0.7576

Epoch 11/29
----------
Training Loss: 0.1896 Acc: 0.9309
Test Loss: 0.8969 Acc: 0.7685

Epoch 12/29
----------
Training Loss: 0.1748 Acc: 0.9361
Test Loss: 0.9792 Acc: 0.7573

Epoch 13/29
----------
Training Loss: 0.1607 Acc: 0.9414
Test Loss: 0.8716 Acc: 0.7698

Epoch 14/29
----------
Training Loss: 0.1380 Acc: 0.9486
Test Loss: 0.9777 Acc: 0.7666

Epoch 15/29
----------
Training Loss: 0.1398 Acc: 0.9472
Test Loss: 0.7479 Acc: 0.7855

Epoch 16/29
----------
Training Loss: 0.1439 Acc: 0.9463
Test Loss: 1.2306 Acc: 0.7573

Epoch 17/29
----------
Training Loss: 0.1443 Acc: 0.9461
Test Loss: 0.9895 Acc: 0.7761

Epoch 18/29
----------
Training Loss: 0.1268 Acc: 0.9530
Test Loss: 0.8564 Acc: 0.7773

Epoch 19/29
----------
Training Loss: 0.1057 Acc: 0.9599
Test Loss: 0.8152 Acc: 0.7888

Epoch 20/29
----------
Training Loss: 0.1069 Acc: 0.9597
Test Loss: 0.9219 Acc: 0.7716

Epoch 21/29
----------
Training Loss: 0.0992 Acc: 0.9623
Test Loss: 0.7616 Acc: 0.7944

Epoch 22/29
----------
Training Loss: 0.0987 Acc: 0.9623
Test Loss: 0.8980 Acc: 0.7750

Epoch 23/29
----------
Training Loss: 0.0854 Acc: 0.9666
Test Loss: 0.7801 Acc: 0.7941

Epoch 24/29
----------
Training Loss: 0.1058 Acc: 0.9590
Test Loss: 0.8962 Acc: 0.7388

Epoch 25/29
----------
Training Loss: 0.1651 Acc: 0.9390
Test Loss: 0.9276 Acc: 0.7680

Epoch 26/29
----------
Training Loss: 0.1143 Acc: 0.9580
Test Loss: 1.0522 Acc: 0.7950

Epoch 27/29
----------
Training Loss: 0.0852 Acc: 0.9671
Test Loss: 0.9501 Acc: 0.7873

Epoch 28/29
----------
Training Loss: 0.0781 Acc: 0.9695
Test Loss: 1.0188 Acc: 0.7894

Epoch 29/29
----------
Training Loss: 0.0833 Acc: 0.9686
Test Loss: 0.8216 Acc: 0.7772

Training complete in 1m 36s
Best val Acc: 0.795016
False
Evaluation Accuray: 0.7950
Edit: 82.5308
F1@0.10 : 87.6404
F1@0.25 : 86.5169
F1@0.50 : 75.2809
