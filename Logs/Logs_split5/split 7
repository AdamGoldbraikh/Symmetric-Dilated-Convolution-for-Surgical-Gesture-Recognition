Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_4', dataset='split7', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_7/test.txt', train_batch_size=1, train_label='Suturing/Split_7/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2123 Acc: 0.2107
Test Loss: 1.8719 Acc: 0.4663

Epoch 1/29
----------
Training Loss: 1.8413 Acc: 0.3917
Test Loss: 1.3025 Acc: 0.5684

Epoch 2/29
----------
Training Loss: 1.3101 Acc: 0.5870
Test Loss: 0.6565 Acc: 0.8450

Epoch 3/29
----------
Training Loss: 0.7554 Acc: 0.7870
Test Loss: 0.3397 Acc: 0.9023

Epoch 4/29
----------
Training Loss: 0.5049 Acc: 0.8451
Test Loss: 0.2470 Acc: 0.9300

Epoch 5/29
----------
Training Loss: 0.4002 Acc: 0.8766
Test Loss: 0.2319 Acc: 0.9273

Epoch 6/29
----------
Training Loss: 0.3166 Acc: 0.9004
Test Loss: 0.1998 Acc: 0.9221

Epoch 7/29
----------
Training Loss: 0.2794 Acc: 0.9089
Test Loss: 0.1877 Acc: 0.9290

Epoch 8/29
----------
Training Loss: 0.2435 Acc: 0.9193
Test Loss: 0.1852 Acc: 0.9315

Epoch 9/29
----------
Training Loss: 0.2189 Acc: 0.9265
Test Loss: 0.1757 Acc: 0.9391

Epoch 10/29
----------
Training Loss: 0.1928 Acc: 0.9317
Test Loss: 0.1698 Acc: 0.9410

Epoch 11/29
----------
Training Loss: 0.1820 Acc: 0.9356
Test Loss: 0.1786 Acc: 0.9394

Epoch 12/29
----------
Training Loss: 0.1617 Acc: 0.9394
Test Loss: 0.1792 Acc: 0.9319

Epoch 13/29
----------
Training Loss: 0.1584 Acc: 0.9428
Test Loss: 0.1791 Acc: 0.9378

Epoch 14/29
----------
Training Loss: 0.1508 Acc: 0.9441
Test Loss: 0.1617 Acc: 0.9436

Epoch 15/29
----------
Training Loss: 0.1362 Acc: 0.9490
Test Loss: 0.1810 Acc: 0.9424

Epoch 16/29
----------
Training Loss: 0.1408 Acc: 0.9464
Test Loss: 0.1919 Acc: 0.9306

Epoch 17/29
----------
Training Loss: 0.1185 Acc: 0.9569
Test Loss: 0.1802 Acc: 0.9405

Epoch 18/29
----------
Training Loss: 0.1087 Acc: 0.9594
Test Loss: 0.1921 Acc: 0.9413

Epoch 19/29
----------
Training Loss: 0.1023 Acc: 0.9608
Test Loss: 0.2318 Acc: 0.9323

Epoch 20/29
----------
Training Loss: 0.1237 Acc: 0.9538
Test Loss: 0.1684 Acc: 0.9457

Epoch 21/29
----------
Training Loss: 0.1228 Acc: 0.9553
Test Loss: 0.2075 Acc: 0.9342

Epoch 22/29
----------
Training Loss: 0.1126 Acc: 0.9559
Test Loss: 0.1983 Acc: 0.9391

Epoch 23/29
----------
Training Loss: 0.1239 Acc: 0.9547
Test Loss: 0.2119 Acc: 0.9355

Epoch 24/29
----------
Training Loss: 0.0996 Acc: 0.9630
Test Loss: 0.2293 Acc: 0.9289

Epoch 25/29
----------
Training Loss: 0.0977 Acc: 0.9620
Test Loss: 0.2053 Acc: 0.9381

Epoch 26/29
----------
Training Loss: 0.0934 Acc: 0.9649
Test Loss: 0.2135 Acc: 0.9421

Epoch 27/29
----------
Training Loss: 0.0911 Acc: 0.9652
Test Loss: 0.1847 Acc: 0.9422

Epoch 28/29
----------
Training Loss: 0.0926 Acc: 0.9649
Test Loss: 0.1956 Acc: 0.9394

Epoch 29/29
----------
Training Loss: 0.0772 Acc: 0.9698
Test Loss: 0.2143 Acc: 0.9434

Training complete in 1m 36s
Best val Acc: 0.945719
False
Evaluation Accuray: 0.9457
Edit: 91.4368
F1@0.10 : 94.4882
F1@0.25 : 94.4882
F1@0.50 : 92.9134
