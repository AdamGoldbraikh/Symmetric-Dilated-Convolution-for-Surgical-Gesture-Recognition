Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_mix', dataset='split1', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_1/test.txt', train_batch_size=1, train_label='Suturing/Split_1/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3115 Acc: 0.1357
Test Loss: 2.1913 Acc: 0.1729

Epoch 1/29
----------
Training Loss: 2.0305 Acc: 0.2664
Test Loss: 1.8953 Acc: 0.3249

Epoch 2/29
----------
Training Loss: 1.8399 Acc: 0.3342
Test Loss: 1.8229 Acc: 0.3038

Epoch 3/29
----------
Training Loss: 1.6780 Acc: 0.3931
Test Loss: 1.7662 Acc: 0.3052

Epoch 4/29
----------
Training Loss: 1.3873 Acc: 0.5118
Test Loss: 1.7369 Acc: 0.3025

Epoch 5/29
----------
Training Loss: 0.9861 Acc: 0.6751
Test Loss: 1.6629 Acc: 0.3601

Epoch 6/29
----------
Training Loss: 0.7470 Acc: 0.7453
Test Loss: 1.5494 Acc: 0.4019

Epoch 7/29
----------
Training Loss: 0.6215 Acc: 0.7858
Test Loss: 1.5564 Acc: 0.4128

Epoch 8/29
----------
Training Loss: 0.5397 Acc: 0.8117
Test Loss: 1.6074 Acc: 0.4313

Epoch 9/29
----------
Training Loss: 0.4843 Acc: 0.8351
Test Loss: 1.6482 Acc: 0.3950

Epoch 10/29
----------
Training Loss: 0.4275 Acc: 0.8488
Test Loss: 1.8943 Acc: 0.3495

Epoch 11/29
----------
Training Loss: 0.3721 Acc: 0.8679
Test Loss: 2.0049 Acc: 0.3742

Epoch 12/29
----------
Training Loss: 0.3194 Acc: 0.8832
Test Loss: 2.1451 Acc: 0.4100

Epoch 13/29
----------
Training Loss: 0.3206 Acc: 0.8829
Test Loss: 1.9342 Acc: 0.3704

Epoch 14/29
----------
Training Loss: 0.2925 Acc: 0.8914
Test Loss: 2.1781 Acc: 0.3599

Epoch 15/29
----------
Training Loss: 0.2528 Acc: 0.9044
Test Loss: 2.3795 Acc: 0.3342

Epoch 16/29
----------
Training Loss: 0.2275 Acc: 0.9158
Test Loss: 2.4152 Acc: 0.3101

Epoch 17/29
----------
Training Loss: 0.2639 Acc: 0.9029
Test Loss: 2.1236 Acc: 0.3450

Epoch 18/29
----------
Training Loss: 0.2200 Acc: 0.9171
Test Loss: 2.4010 Acc: 0.2985

Epoch 19/29
----------
Training Loss: 0.1937 Acc: 0.9261
Test Loss: 1.9521 Acc: 0.4306

Epoch 20/29
----------
Training Loss: 0.1925 Acc: 0.9277
Test Loss: 2.1096 Acc: 0.3767

Epoch 21/29
----------
Training Loss: 0.1787 Acc: 0.9322
Test Loss: 2.4983 Acc: 0.3091

Epoch 22/29
----------
Training Loss: 0.1843 Acc: 0.9312
Test Loss: 2.8110 Acc: 0.2477

Epoch 23/29
----------
Training Loss: 0.1861 Acc: 0.9289
Test Loss: 2.1747 Acc: 0.3463

Epoch 24/29
----------
Training Loss: 0.1758 Acc: 0.9339
Test Loss: 2.5976 Acc: 0.2981

Epoch 25/29
----------
Training Loss: 0.1665 Acc: 0.9388
Test Loss: 3.4609 Acc: 0.1590

Epoch 26/29
----------
Training Loss: 0.1838 Acc: 0.9339
Test Loss: 3.6287 Acc: 0.2580

Epoch 27/29
----------
Training Loss: 0.1523 Acc: 0.9439
Test Loss: 3.8416 Acc: 0.1539

Epoch 28/29
----------
Training Loss: 0.1521 Acc: 0.9452
Test Loss: 2.6850 Acc: 0.2651

Epoch 29/29
----------
Training Loss: 0.1439 Acc: 0.9477
Test Loss: 2.4598 Acc: 0.3878

Training complete in 1m 14s
Best val Acc: 0.431280
False
Evaluation Accuray: 0.4313
Edit: 33.3060
F1@0.10 : 32.5926
F1@0.25 : 25.1852
F1@0.50 : 11.8519
