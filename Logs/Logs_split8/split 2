Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_8', dataset='split2', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_2/test.txt', train_batch_size=1, train_label='Suturing/Split_2/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2149 Acc: 0.1920
Test Loss: 1.8541 Acc: 0.3668

Epoch 1/29
----------
Training Loss: 1.8124 Acc: 0.3917
Test Loss: 1.3933 Acc: 0.4548

Epoch 2/29
----------
Training Loss: 1.3504 Acc: 0.5714
Test Loss: 0.8300 Acc: 0.7494

Epoch 3/29
----------
Training Loss: 0.8831 Acc: 0.7366
Test Loss: 0.4961 Acc: 0.8285

Epoch 4/29
----------
Training Loss: 0.6028 Acc: 0.8144
Test Loss: 0.3902 Acc: 0.8660

Epoch 5/29
----------
Training Loss: 0.4732 Acc: 0.8486
Test Loss: 0.3150 Acc: 0.8966

Epoch 6/29
----------
Training Loss: 0.3771 Acc: 0.8778
Test Loss: 0.2886 Acc: 0.9074

Epoch 7/29
----------
Training Loss: 0.3136 Acc: 0.8939
Test Loss: 0.2983 Acc: 0.9071

Epoch 8/29
----------
Training Loss: 0.2791 Acc: 0.9036
Test Loss: 0.3084 Acc: 0.9085

Epoch 9/29
----------
Training Loss: 0.2480 Acc: 0.9137
Test Loss: 0.2795 Acc: 0.9179

Epoch 10/29
----------
Training Loss: 0.2245 Acc: 0.9184
Test Loss: 0.2759 Acc: 0.9207

Epoch 11/29
----------
Training Loss: 0.2011 Acc: 0.9297
Test Loss: 0.2808 Acc: 0.9233

Epoch 12/29
----------
Training Loss: 0.1804 Acc: 0.9334
Test Loss: 0.2819 Acc: 0.9212

Epoch 13/29
----------
Training Loss: 0.1658 Acc: 0.9386
Test Loss: 0.3474 Acc: 0.9155

Epoch 14/29
----------
Training Loss: 0.1570 Acc: 0.9412
Test Loss: 0.2636 Acc: 0.9239

Epoch 15/29
----------
Training Loss: 0.1553 Acc: 0.9418
Test Loss: 0.3304 Acc: 0.9121

Epoch 16/29
----------
Training Loss: 0.1290 Acc: 0.9519
Test Loss: 0.3690 Acc: 0.9122

Epoch 17/29
----------
Training Loss: 0.1490 Acc: 0.9428
Test Loss: 0.3019 Acc: 0.9138

Epoch 18/29
----------
Training Loss: 0.1630 Acc: 0.9435
Test Loss: 0.2892 Acc: 0.9179

Epoch 19/29
----------
Training Loss: 0.1347 Acc: 0.9503
Test Loss: 0.3437 Acc: 0.9197

Epoch 20/29
----------
Training Loss: 0.1127 Acc: 0.9572
Test Loss: 0.3616 Acc: 0.9119

Epoch 21/29
----------
Training Loss: 0.1088 Acc: 0.9588
Test Loss: 0.3187 Acc: 0.9168

Epoch 22/29
----------
Training Loss: 0.1172 Acc: 0.9543
Test Loss: 0.3095 Acc: 0.9095

Epoch 23/29
----------
Training Loss: 0.1077 Acc: 0.9592
Test Loss: 0.3497 Acc: 0.9138

Epoch 24/29
----------
Training Loss: 0.1033 Acc: 0.9605
Test Loss: 0.3451 Acc: 0.9201

Epoch 25/29
----------
Training Loss: 0.0964 Acc: 0.9623
Test Loss: 0.3512 Acc: 0.9237

Epoch 26/29
----------
Training Loss: 0.0892 Acc: 0.9655
Test Loss: 0.3781 Acc: 0.9175

Epoch 27/29
----------
Training Loss: 0.1002 Acc: 0.9623
Test Loss: 0.3039 Acc: 0.9181

Epoch 28/29
----------
Training Loss: 0.1859 Acc: 0.9363
Test Loss: 0.4503 Acc: 0.9006

Epoch 29/29
----------
Training Loss: 0.1366 Acc: 0.9489
Test Loss: 0.3112 Acc: 0.9186

Training complete in 1m 13s
Best val Acc: 0.923877
False
Evaluation Accuray: 0.9239
Edit: 98.7500
F1@0.10 : 99.3464
F1@0.25 : 99.3464
F1@0.50 : 99.3464
