Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_8', dataset='split7', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_7/test.txt', train_batch_size=1, train_label='Suturing/Split_7/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.4008 Acc: 0.1079
Test Loss: 2.0017 Acc: 0.3977

Epoch 1/29
----------
Training Loss: 1.8816 Acc: 0.3768
Test Loss: 1.3500 Acc: 0.5285

Epoch 2/29
----------
Training Loss: 1.3520 Acc: 0.5684
Test Loss: 0.7957 Acc: 0.7983

Epoch 3/29
----------
Training Loss: 0.8659 Acc: 0.7469
Test Loss: 0.4468 Acc: 0.8473

Epoch 4/29
----------
Training Loss: 0.5919 Acc: 0.8164
Test Loss: 0.2853 Acc: 0.9041

Epoch 5/29
----------
Training Loss: 0.4594 Acc: 0.8550
Test Loss: 0.2416 Acc: 0.9002

Epoch 6/29
----------
Training Loss: 0.3796 Acc: 0.8778
Test Loss: 0.2088 Acc: 0.9294

Epoch 7/29
----------
Training Loss: 0.3231 Acc: 0.8944
Test Loss: 0.1698 Acc: 0.9355

Epoch 8/29
----------
Training Loss: 0.2802 Acc: 0.9060
Test Loss: 0.1622 Acc: 0.9339

Epoch 9/29
----------
Training Loss: 0.2462 Acc: 0.9130
Test Loss: 0.1212 Acc: 0.9556

Epoch 10/29
----------
Training Loss: 0.2217 Acc: 0.9213
Test Loss: 0.2010 Acc: 0.9198

Epoch 11/29
----------
Training Loss: 0.2104 Acc: 0.9245
Test Loss: 0.1787 Acc: 0.9318

Epoch 12/29
----------
Training Loss: 0.1973 Acc: 0.9290
Test Loss: 0.1437 Acc: 0.9503

Epoch 13/29
----------
Training Loss: 0.1778 Acc: 0.9344
Test Loss: 0.1663 Acc: 0.9395

Epoch 14/29
----------
Training Loss: 0.1670 Acc: 0.9370
Test Loss: 0.1447 Acc: 0.9461

Epoch 15/29
----------
Training Loss: 0.1618 Acc: 0.9404
Test Loss: 0.1859 Acc: 0.9308

Epoch 16/29
----------
Training Loss: 0.1760 Acc: 0.9351
Test Loss: 0.1739 Acc: 0.9385

Epoch 17/29
----------
Training Loss: 0.1542 Acc: 0.9423
Test Loss: 0.1815 Acc: 0.9356

Epoch 18/29
----------
Training Loss: 0.1440 Acc: 0.9449
Test Loss: 0.2197 Acc: 0.9197

Epoch 19/29
----------
Training Loss: 0.1312 Acc: 0.9506
Test Loss: 0.1689 Acc: 0.9415

Epoch 20/29
----------
Training Loss: 0.1338 Acc: 0.9503
Test Loss: 0.2176 Acc: 0.9182

Epoch 21/29
----------
Training Loss: 0.1247 Acc: 0.9522
Test Loss: 0.1791 Acc: 0.9445

Epoch 22/29
----------
Training Loss: 0.1167 Acc: 0.9549
Test Loss: 0.2238 Acc: 0.9341

Epoch 23/29
----------
Training Loss: 0.1088 Acc: 0.9594
Test Loss: 0.2127 Acc: 0.9350

Epoch 24/29
----------
Training Loss: 0.1040 Acc: 0.9604
Test Loss: 0.2083 Acc: 0.9395

Epoch 25/29
----------
Training Loss: 0.1248 Acc: 0.9536
Test Loss: 0.2551 Acc: 0.9279

Epoch 26/29
----------
Training Loss: 0.1551 Acc: 0.9422
Test Loss: 0.1945 Acc: 0.9355

Epoch 27/29
----------
Training Loss: 0.1131 Acc: 0.9577
Test Loss: 0.1596 Acc: 0.9500

Epoch 28/29
----------
Training Loss: 0.0962 Acc: 0.9628
Test Loss: 0.1777 Acc: 0.9438

Epoch 29/29
----------
Training Loss: 0.0871 Acc: 0.9664
Test Loss: 0.2457 Acc: 0.9403

Training complete in 1m 18s
Best val Acc: 0.955646
False
Evaluation Accuray: 0.9556
Edit: 95.4293
F1@0.10 : 97.5610
F1@0.25 : 97.5610
F1@0.50 : 94.3089
