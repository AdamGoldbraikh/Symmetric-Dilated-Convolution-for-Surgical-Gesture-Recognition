Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_8', dataset='split5', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_5/test.txt', train_batch_size=1, train_label='Suturing/Split_5/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.1703 Acc: 0.2357
Test Loss: 1.8372 Acc: 0.4277

Epoch 1/29
----------
Training Loss: 1.8392 Acc: 0.3700
Test Loss: 1.2961 Acc: 0.5349

Epoch 2/29
----------
Training Loss: 1.3909 Acc: 0.5510
Test Loss: 0.7130 Acc: 0.8248

Epoch 3/29
----------
Training Loss: 0.8801 Acc: 0.7353
Test Loss: 0.3814 Acc: 0.8964

Epoch 4/29
----------
Training Loss: 0.6012 Acc: 0.8089
Test Loss: 0.2974 Acc: 0.8851

Epoch 5/29
----------
Training Loss: 0.4699 Acc: 0.8518
Test Loss: 0.2114 Acc: 0.9204

Epoch 6/29
----------
Training Loss: 0.3868 Acc: 0.8754
Test Loss: 0.1870 Acc: 0.9381

Epoch 7/29
----------
Training Loss: 0.3170 Acc: 0.8925
Test Loss: 0.1817 Acc: 0.9379

Epoch 8/29
----------
Training Loss: 0.2940 Acc: 0.9026
Test Loss: 0.1677 Acc: 0.9421

Epoch 9/29
----------
Training Loss: 0.2603 Acc: 0.9136
Test Loss: 0.1755 Acc: 0.9346

Epoch 10/29
----------
Training Loss: 0.2369 Acc: 0.9166
Test Loss: 0.1940 Acc: 0.9241

Epoch 11/29
----------
Training Loss: 0.2157 Acc: 0.9236
Test Loss: 0.1915 Acc: 0.9297

Epoch 12/29
----------
Training Loss: 0.2038 Acc: 0.9271
Test Loss: 0.1769 Acc: 0.9325

Epoch 13/29
----------
Training Loss: 0.1880 Acc: 0.9321
Test Loss: 0.1594 Acc: 0.9445

Epoch 14/29
----------
Training Loss: 0.1628 Acc: 0.9400
Test Loss: 0.2016 Acc: 0.9330

Epoch 15/29
----------
Training Loss: 0.1703 Acc: 0.9386
Test Loss: 0.1645 Acc: 0.9434

Epoch 16/29
----------
Training Loss: 0.1618 Acc: 0.9407
Test Loss: 0.1730 Acc: 0.9446

Epoch 17/29
----------
Training Loss: 0.1563 Acc: 0.9394
Test Loss: 0.2077 Acc: 0.9308

Epoch 18/29
----------
Training Loss: 0.1384 Acc: 0.9473
Test Loss: 0.1632 Acc: 0.9424

Epoch 19/29
----------
Training Loss: 0.1428 Acc: 0.9476
Test Loss: 0.1846 Acc: 0.9360

Epoch 20/29
----------
Training Loss: 0.1357 Acc: 0.9483
Test Loss: 0.2638 Acc: 0.9259

Epoch 21/29
----------
Training Loss: 0.1245 Acc: 0.9537
Test Loss: 0.1682 Acc: 0.9427

Epoch 22/29
----------
Training Loss: 0.1057 Acc: 0.9605
Test Loss: 0.1678 Acc: 0.9434

Epoch 23/29
----------
Training Loss: 0.1039 Acc: 0.9600
Test Loss: 0.1836 Acc: 0.9390

Epoch 24/29
----------
Training Loss: 0.1013 Acc: 0.9616
Test Loss: 0.1699 Acc: 0.9447

Epoch 25/29
----------
Training Loss: 0.0981 Acc: 0.9630
Test Loss: 0.3386 Acc: 0.9094

Epoch 26/29
----------
Training Loss: 0.1324 Acc: 0.9518
Test Loss: 0.1920 Acc: 0.9374

Epoch 27/29
----------
Training Loss: 0.1059 Acc: 0.9612
Test Loss: 0.2252 Acc: 0.9265

Epoch 28/29
----------
Training Loss: 0.1105 Acc: 0.9589
Test Loss: 0.2542 Acc: 0.9294

Epoch 29/29
----------
Training Loss: 0.0851 Acc: 0.9682
Test Loss: 0.2490 Acc: 0.9299

Training complete in 1m 14s
Best val Acc: 0.944685
False
Evaluation Accuray: 0.9447
Edit: 97.4342
F1@0.10 : 98.6301
F1@0.25 : 98.6301
F1@0.50 : 98.6301
