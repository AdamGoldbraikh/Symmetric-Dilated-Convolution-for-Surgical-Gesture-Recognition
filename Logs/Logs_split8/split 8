Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_8', dataset='split8', dropout=0.5, epoch=30, gpu_id=1, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_8/test.txt', train_batch_size=1, train_label='Suturing/Split_8/train.txt')
cuda:1
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.2281 Acc: 0.1704
Test Loss: 1.9673 Acc: 0.3340

Epoch 1/29
----------
Training Loss: 1.7943 Acc: 0.3880
Test Loss: 1.5611 Acc: 0.3665

Epoch 2/29
----------
Training Loss: 1.2823 Acc: 0.6022
Test Loss: 1.1465 Acc: 0.5552

Epoch 3/29
----------
Training Loss: 0.7907 Acc: 0.7801
Test Loss: 0.9641 Acc: 0.6890

Epoch 4/29
----------
Training Loss: 0.5201 Acc: 0.8379
Test Loss: 0.7625 Acc: 0.7882

Epoch 5/29
----------
Training Loss: 0.3861 Acc: 0.8764
Test Loss: 0.7747 Acc: 0.7924

Epoch 6/29
----------
Training Loss: 0.3300 Acc: 0.8898
Test Loss: 0.7295 Acc: 0.7987

Epoch 7/29
----------
Training Loss: 0.2835 Acc: 0.9036
Test Loss: 0.8843 Acc: 0.7816

Epoch 8/29
----------
Training Loss: 0.2322 Acc: 0.9178
Test Loss: 0.8214 Acc: 0.7847

Epoch 9/29
----------
Training Loss: 0.2033 Acc: 0.9265
Test Loss: 0.8142 Acc: 0.8056

Epoch 10/29
----------
Training Loss: 0.1891 Acc: 0.9324
Test Loss: 0.8607 Acc: 0.7931

Epoch 11/29
----------
Training Loss: 0.1583 Acc: 0.9430
Test Loss: 0.8987 Acc: 0.7918

Epoch 12/29
----------
Training Loss: 0.1520 Acc: 0.9428
Test Loss: 0.9957 Acc: 0.7794

Epoch 13/29
----------
Training Loss: 0.1506 Acc: 0.9434
Test Loss: 0.8674 Acc: 0.7989

Epoch 14/29
----------
Training Loss: 0.1389 Acc: 0.9483
Test Loss: 0.8590 Acc: 0.8170

Epoch 15/29
----------
Training Loss: 0.1222 Acc: 0.9545
Test Loss: 1.1322 Acc: 0.7666

Epoch 16/29
----------
Training Loss: 0.1276 Acc: 0.9524
Test Loss: 0.8040 Acc: 0.8435

Epoch 17/29
----------
Training Loss: 0.1350 Acc: 0.9500
Test Loss: 0.9502 Acc: 0.7950

Epoch 18/29
----------
Training Loss: 0.1125 Acc: 0.9579
Test Loss: 1.1262 Acc: 0.7744

Epoch 19/29
----------
Training Loss: 0.1049 Acc: 0.9596
Test Loss: 1.1883 Acc: 0.7676

Epoch 20/29
----------
Training Loss: 0.1065 Acc: 0.9592
Test Loss: 1.0044 Acc: 0.7947

Epoch 21/29
----------
Training Loss: 0.0969 Acc: 0.9619
Test Loss: 0.9851 Acc: 0.7936

Epoch 22/29
----------
Training Loss: 0.1027 Acc: 0.9613
Test Loss: 0.9767 Acc: 0.8039

Epoch 23/29
----------
Training Loss: 0.1096 Acc: 0.9586
Test Loss: 1.1220 Acc: 0.7510

Epoch 24/29
----------
Training Loss: 0.0912 Acc: 0.9649
Test Loss: 0.9083 Acc: 0.8143

Epoch 25/29
----------
Training Loss: 0.0838 Acc: 0.9672
Test Loss: 1.0544 Acc: 0.7950

Epoch 26/29
----------
Training Loss: 0.0909 Acc: 0.9649
Test Loss: 1.0670 Acc: 0.7766

Epoch 27/29
----------
Training Loss: 0.0839 Acc: 0.9677
Test Loss: 1.3479 Acc: 0.7551

Epoch 28/29
----------
Training Loss: 0.0893 Acc: 0.9661
Test Loss: 0.9754 Acc: 0.7987

Epoch 29/29
----------
Training Loss: 0.0783 Acc: 0.9715
Test Loss: 1.0808 Acc: 0.8002

Training complete in 1m 17s
Best val Acc: 0.843529
False
Evaluation Accuray: 0.8435
Edit: 72.3474
F1@0.10 : 81.2834
F1@0.25 : 79.1444
F1@0.50 : 71.6578
