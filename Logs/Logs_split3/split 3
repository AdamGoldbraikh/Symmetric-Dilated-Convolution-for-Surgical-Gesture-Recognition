Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_3', dataset='split3', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_3/test.txt', train_batch_size=1, train_label='Suturing/Split_3/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.1972 Acc: 0.1938
Test Loss: 2.0193 Acc: 0.3115

Epoch 1/29
----------
Training Loss: 1.7897 Acc: 0.3794
Test Loss: 1.7668 Acc: 0.4285

Epoch 2/29
----------
Training Loss: 1.2445 Acc: 0.6095
Test Loss: 1.5429 Acc: 0.5954

Epoch 3/29
----------
Training Loss: 0.7080 Acc: 0.7986
Test Loss: 1.6584 Acc: 0.6142

Epoch 4/29
----------
Training Loss: 0.4510 Acc: 0.8644
Test Loss: 1.8477 Acc: 0.6145

Epoch 5/29
----------
Training Loss: 0.3518 Acc: 0.8879
Test Loss: 1.7109 Acc: 0.6284

Epoch 6/29
----------
Training Loss: 0.2919 Acc: 0.9028
Test Loss: 1.6996 Acc: 0.6303

Epoch 7/29
----------
Training Loss: 0.2521 Acc: 0.9123
Test Loss: 1.7196 Acc: 0.6200

Epoch 8/29
----------
Training Loss: 0.2135 Acc: 0.9233
Test Loss: 1.8360 Acc: 0.6193

Epoch 9/29
----------
Training Loss: 0.1933 Acc: 0.9304
Test Loss: 1.6363 Acc: 0.6445

Epoch 10/29
----------
Training Loss: 0.1701 Acc: 0.9386
Test Loss: 1.7466 Acc: 0.6329

Epoch 11/29
----------
Training Loss: 0.1596 Acc: 0.9419
Test Loss: 1.8163 Acc: 0.6096

Epoch 12/29
----------
Training Loss: 0.1577 Acc: 0.9428
Test Loss: 1.8508 Acc: 0.6403

Epoch 13/29
----------
Training Loss: 0.1409 Acc: 0.9470
Test Loss: 1.8953 Acc: 0.6062

Epoch 14/29
----------
Training Loss: 0.1276 Acc: 0.9520
Test Loss: 1.9765 Acc: 0.6110

Epoch 15/29
----------
Training Loss: 0.1124 Acc: 0.9581
Test Loss: 2.1160 Acc: 0.6124

Epoch 16/29
----------
Training Loss: 0.1036 Acc: 0.9601
Test Loss: 1.6208 Acc: 0.6639

Epoch 17/29
----------
Training Loss: 0.1323 Acc: 0.9501
Test Loss: 2.2679 Acc: 0.5933

Epoch 18/29
----------
Training Loss: 0.1105 Acc: 0.9583
Test Loss: 1.9785 Acc: 0.6328

Epoch 19/29
----------
Training Loss: 0.0917 Acc: 0.9643
Test Loss: 2.0887 Acc: 0.6109

Epoch 20/29
----------
Training Loss: 0.0891 Acc: 0.9652
Test Loss: 1.7899 Acc: 0.6224

Epoch 21/29
----------
Training Loss: 0.0945 Acc: 0.9647
Test Loss: 2.1674 Acc: 0.6217

Epoch 22/29
----------
Training Loss: 0.0999 Acc: 0.9617
Test Loss: 2.2553 Acc: 0.5891

Epoch 23/29
----------
Training Loss: 0.1250 Acc: 0.9521
Test Loss: 2.2037 Acc: 0.5923

Epoch 24/29
----------
Training Loss: 0.0917 Acc: 0.9642
Test Loss: 2.2700 Acc: 0.6048

Epoch 25/29
----------
Training Loss: 0.0719 Acc: 0.9720
Test Loss: 2.0590 Acc: 0.6436

Epoch 26/29
----------
Training Loss: 0.0756 Acc: 0.9707
Test Loss: 2.3160 Acc: 0.6104

Epoch 27/29
----------
Training Loss: 0.0757 Acc: 0.9696
Test Loss: 2.1453 Acc: 0.6246

Epoch 28/29
----------
Training Loss: 0.0834 Acc: 0.9677
Test Loss: 2.0982 Acc: 0.6521

Epoch 29/29
----------
Training Loss: 0.0856 Acc: 0.9666
Test Loss: 1.9668 Acc: 0.6175

Training complete in 1m 15s
Best val Acc: 0.663897
False
Evaluation Accuray: 0.6639
Edit: 68.3333
F1@0.10 : 76.8421
F1@0.25 : 70.5263
F1@0.50 : 58.9474
