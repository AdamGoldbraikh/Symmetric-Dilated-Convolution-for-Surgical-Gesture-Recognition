Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_3', dataset='split1', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_1/test.txt', train_batch_size=1, train_label='Suturing/Split_1/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3957 Acc: 0.1089
Test Loss: 2.0710 Acc: 0.3181

Epoch 1/29
----------
Training Loss: 1.9849 Acc: 0.3075
Test Loss: 1.4478 Acc: 0.5100

Epoch 2/29
----------
Training Loss: 1.4993 Acc: 0.5063
Test Loss: 0.9466 Acc: 0.7647

Epoch 3/29
----------
Training Loss: 0.9013 Acc: 0.7406
Test Loss: 0.5732 Acc: 0.8292

Epoch 4/29
----------
Training Loss: 0.5998 Acc: 0.8104
Test Loss: 0.5132 Acc: 0.8423

Epoch 5/29
----------
Training Loss: 0.4616 Acc: 0.8478
Test Loss: 0.4316 Acc: 0.8644

Epoch 6/29
----------
Training Loss: 0.3901 Acc: 0.8666
Test Loss: 0.4076 Acc: 0.8914

Epoch 7/29
----------
Training Loss: 0.3409 Acc: 0.8817
Test Loss: 0.4514 Acc: 0.8990

Epoch 8/29
----------
Training Loss: 0.2971 Acc: 0.8973
Test Loss: 0.4053 Acc: 0.8983

Epoch 9/29
----------
Training Loss: 0.2565 Acc: 0.9110
Test Loss: 0.4508 Acc: 0.9061

Epoch 10/29
----------
Training Loss: 0.2272 Acc: 0.9196
Test Loss: 0.4257 Acc: 0.9039

Epoch 11/29
----------
Training Loss: 0.2011 Acc: 0.9263
Test Loss: 0.4468 Acc: 0.8954

Epoch 12/29
----------
Training Loss: 0.1912 Acc: 0.9304
Test Loss: 0.4700 Acc: 0.9046

Epoch 13/29
----------
Training Loss: 0.1722 Acc: 0.9380
Test Loss: 0.4455 Acc: 0.9081

Epoch 14/29
----------
Training Loss: 0.1615 Acc: 0.9412
Test Loss: 0.4343 Acc: 0.9051

Epoch 15/29
----------
Training Loss: 0.1646 Acc: 0.9402
Test Loss: 0.4018 Acc: 0.9048

Epoch 16/29
----------
Training Loss: 0.1498 Acc: 0.9448
Test Loss: 0.4661 Acc: 0.9078

Epoch 17/29
----------
Training Loss: 0.1485 Acc: 0.9443
Test Loss: 0.5127 Acc: 0.9019

Epoch 18/29
----------
Training Loss: 0.1532 Acc: 0.9416
Test Loss: 0.4831 Acc: 0.9017

Epoch 19/29
----------
Training Loss: 0.1320 Acc: 0.9511
Test Loss: 0.5048 Acc: 0.9005

Epoch 20/29
----------
Training Loss: 0.1374 Acc: 0.9495
Test Loss: 0.4967 Acc: 0.9093

Epoch 21/29
----------
Training Loss: 0.1081 Acc: 0.9585
Test Loss: 0.5817 Acc: 0.8896

Epoch 22/29
----------
Training Loss: 0.1166 Acc: 0.9552
Test Loss: 0.5382 Acc: 0.8947

Epoch 23/29
----------
Training Loss: 0.1101 Acc: 0.9565
Test Loss: 0.5462 Acc: 0.8990

Epoch 24/29
----------
Training Loss: 0.1216 Acc: 0.9538
Test Loss: 0.4721 Acc: 0.8945

Epoch 25/29
----------
Training Loss: 0.1276 Acc: 0.9525
Test Loss: 0.4750 Acc: 0.9011

Epoch 26/29
----------
Training Loss: 0.1422 Acc: 0.9488
Test Loss: 0.5735 Acc: 0.8846

Epoch 27/29
----------
Training Loss: 0.1202 Acc: 0.9559
Test Loss: 0.5399 Acc: 0.9008

Epoch 28/29
----------
Training Loss: 0.0977 Acc: 0.9631
Test Loss: 0.5528 Acc: 0.8996

Epoch 29/29
----------
Training Loss: 0.0842 Acc: 0.9673
Test Loss: 0.5996 Acc: 0.8955

Training complete in 1m 12s
Best val Acc: 0.909271
False
Evaluation Accuray: 0.9093
Edit: 95.0000
F1@0.10 : 97.2973
F1@0.25 : 95.9459
F1@0.50 : 91.8919
