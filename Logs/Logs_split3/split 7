Namespace(cuda=True, d_inner_hid=512, d_k=16, d_model=128, d_v=16, data_root='SpatialCNN/Split_3', dataset='split7', dropout=0.5, epoch=30, gpu_id=0, lr=0.01, n_classes=10, n_dlayers=10, n_head=1, n_layers=1, n_position=5000, n_warmup_steps=4000, num_f_maps=128, num_workers=8, test_batch_size=1, test_label='Suturing/Split_7/test.txt', train_batch_size=1, train_label='Suturing/Split_7/train.txt')
cuda:0
Epoch 0/29
----------
/data/home/orrubin/.local/lib/python3.6/site-packages/torch/nn/functional.py:652: UserWarning: Named tensors and all their associated APIs are an experimental feature and subject to change. Please do not use them for anything important until they are released as stable. (Triggered internally at  /pytorch/c10/core/TensorImpl.h:1156.)
  return torch.max_pool1d(input, kernel_size, stride, padding, dilation, ceil_mode)
Training Loss: 2.3373 Acc: 0.1408
Test Loss: 2.0627 Acc: 0.2840

Epoch 1/29
----------
Training Loss: 1.8213 Acc: 0.3894
Test Loss: 1.3035 Acc: 0.5850

Epoch 2/29
----------
Training Loss: 1.2968 Acc: 0.5901
Test Loss: 0.7249 Acc: 0.7931

Epoch 3/29
----------
Training Loss: 0.8325 Acc: 0.7525
Test Loss: 0.4010 Acc: 0.8706

Epoch 4/29
----------
Training Loss: 0.5736 Acc: 0.8233
Test Loss: 0.2843 Acc: 0.9237

Epoch 5/29
----------
Training Loss: 0.4652 Acc: 0.8501
Test Loss: 0.2257 Acc: 0.9343

Epoch 6/29
----------
Training Loss: 0.3922 Acc: 0.8705
Test Loss: 0.1639 Acc: 0.9551

Epoch 7/29
----------
Training Loss: 0.3196 Acc: 0.8894
Test Loss: 0.1695 Acc: 0.9384

Epoch 8/29
----------
Training Loss: 0.2818 Acc: 0.9008
Test Loss: 0.1513 Acc: 0.9462

Epoch 9/29
----------
Training Loss: 0.2504 Acc: 0.9108
Test Loss: 0.1731 Acc: 0.9346

Epoch 10/29
----------
Training Loss: 0.2214 Acc: 0.9200
Test Loss: 0.1594 Acc: 0.9383

Epoch 11/29
----------
Training Loss: 0.2121 Acc: 0.9233
Test Loss: 0.1489 Acc: 0.9410

Epoch 12/29
----------
Training Loss: 0.2005 Acc: 0.9275
Test Loss: 0.1282 Acc: 0.9529

Epoch 13/29
----------
Training Loss: 0.1824 Acc: 0.9340
Test Loss: 0.1740 Acc: 0.9383

Epoch 14/29
----------
Training Loss: 0.1697 Acc: 0.9380
Test Loss: 0.1584 Acc: 0.9461

Epoch 15/29
----------
Training Loss: 0.1625 Acc: 0.9388
Test Loss: 0.1671 Acc: 0.9400

Epoch 16/29
----------
Training Loss: 0.1564 Acc: 0.9418
Test Loss: 0.1636 Acc: 0.9453

Epoch 17/29
----------
Training Loss: 0.1412 Acc: 0.9480
Test Loss: 0.1701 Acc: 0.9443

Epoch 18/29
----------
Training Loss: 0.1714 Acc: 0.9356
Test Loss: 0.2258 Acc: 0.9322

Epoch 19/29
----------
Training Loss: 0.1474 Acc: 0.9463
Test Loss: 0.1637 Acc: 0.9444

Epoch 20/29
----------
Training Loss: 0.1770 Acc: 0.9402
Test Loss: 0.1637 Acc: 0.9459

Epoch 21/29
----------
Training Loss: 0.1239 Acc: 0.9532
Test Loss: 0.1530 Acc: 0.9473

Epoch 22/29
----------
Training Loss: 0.1197 Acc: 0.9544
Test Loss: 0.2576 Acc: 0.9154

Epoch 23/29
----------
Training Loss: 0.1341 Acc: 0.9503
Test Loss: 0.1851 Acc: 0.9345

Epoch 24/29
----------
Training Loss: 0.1288 Acc: 0.9496
Test Loss: 0.1998 Acc: 0.9400

Epoch 25/29
----------
Training Loss: 0.1449 Acc: 0.9440
Test Loss: 0.1948 Acc: 0.9295

Epoch 26/29
----------
Training Loss: 0.1244 Acc: 0.9523
Test Loss: 0.2021 Acc: 0.9364

Epoch 27/29
----------
Training Loss: 0.1047 Acc: 0.9597
Test Loss: 0.2161 Acc: 0.9351

Epoch 28/29
----------
Training Loss: 0.0859 Acc: 0.9666
Test Loss: 0.2554 Acc: 0.9179

Epoch 29/29
----------
Training Loss: 0.1109 Acc: 0.9578
Test Loss: 0.2477 Acc: 0.9351

Training complete in 1m 14s
Best val Acc: 0.955075
False
Evaluation Accuray: 0.9551
Edit: 85.6522
F1@0.10 : 91.2000
F1@0.25 : 91.2000
F1@0.50 : 89.6000
